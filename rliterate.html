<h1>RLiterate</h1>

<p>RLiterate is a tool for reading and authoring documents. Documents have pages organized in a hierarchy. Pages have a title and paragraphs. Paragraphs can be of different types. The different paragraph types is what makes RLiterate documents special. Code paragraphs for example enable literate programming by allowing chunks of code to be defined and then be automatically assembled into the final source file. Text paragraphs are used for writing prose. RLiterate documents can also be exported to different formats for display in different mediums.
</p>

<h2>A tour of RLiterate</h2>

<p>This chapter gives an overview what RLiterate looks like.</p>

<h3>Main GUI</h3>

<p>* smallest federated wiki inspired the factory and the editing workflow
* leo and smallest federated wiki inspired TOC and seeing a single page/node at a time</p>

<h3>Reading tool</h3>

<p>RLiterate is a reading and thinking tool. The following features support that.</p>

<p>Hoisting a page in the table of contents allows you to **focus on a subset** of the document.</p>

<p>Openining a page and all immediate children (double click on a page in the table of contents) allows you to read a subset of the document **breath first**. It's like reading only the first paragraph in an entire book.</p>

<h3>Literate programming</h3>

<p>Describe how code paragraphs enable literate programming.</p>

<h2>Background</h2>

<p>Many things inspired RLiterate, but the initial thought was triggered by the paper [Active Essays on the Web](http://www.vpri.org/pdf/tr2009002_active_essays.pdf). In it they talk about embedding code in documents that the reader can interact with. They also mention [Literate programming](https://en.wikipedia.org/wiki/Literate_programming) as having a related goal.</p>

<p>At the time I was working on a program that I thought would be nice to express in this way. I wanted to write an article about the program and have the code for the program embedded in the article. I could have used a literate programming tool for this, but the interactive aspect of active essays made me think that a tool would be much more powerful if the document could be edited "live", similar to WYSIWYG editors. Literate programming tools I were aware of worked by editing plain text files with a special syntax for code and documentation blocks, thus lacking the interactive aspect.</p>

<h3>The prototype</h3>

<p>So I decided to build a prototype to learn what such a tool might be like.
</p>

<p>First I came up with a document model where pages were organized in a hierarchy and where each page had paragraphs that could be of different types. This idea was stolen from [Smallest Federated Wiki](https://en.wikipedia.org/wiki/Smallest_Federated_Wiki). The code paragraph would allow for literate programming. I also envisioned other paragraph types that would allow for more interaction. Perhaps one paragraph type could be [Graphviz](http://graphviz.org/) code, and when edited, a generated graph would appear instead of the code.</p>

<p>After coming up with a document model, I implement a GUI that would allow editing such documents. This GUI had to be first class as it would be the primary way to read and author documents.</p>

<p>At a certain point I had all the functionality in place for doing literate programming. Then I imported all the code into an RLiterate document (previously it was written as a single Python file) and started extracting pieces and adding prose to explain the program. As I went along I noticed features I was lacking.</p>

<h3>Why literate programming?</h3>

<p>To me, the most central idea in literate programming is that we should write programs for other humans. Only secondary for the machine. I find code easier to understand if I can understand it in isolated pieces. One example where it is difficult to isolate a piece without literate programming is test code. Usually the test code is located in one file, and the implementation in another. To fully understand the piece it is useful to both read the tests and the implementation. To do this we have to find this related information in two unrelated files. I wrote about this problem in 2003 in [Related things are not kept together](http://rickardlindberg.me/writing/reflections-on-programming/2013-02-24-related-things-are-not-kept-together/). Literate programming allows us to present the test and the implementation in the same place, yet have the different pieces written to different files. The compiler might require that they are in separate files, but with literate programming, we care first about the other human that will read our code, and only second about the compiler.</p>

<p>Another argument for literate programming is to express the "why". Why is this code here? Timothy Daly talks about it in his talk [Literate Programming in the Large](https://www.youtube.com/watch?v=Av0PQDVTP4A). He also argues that programmers must change the mindset from wring a program to writing a book. Some more can be read here: http://axiom-developer.org/axiom-website/litprog.html.</p>

<p>Some more resources about literate programming:

* https://www.youtube.com/watch?v=5V1ynVyud4M
  "Eve" by Chris Granger

* http://eve-lang.com/deepdives/literate.html

* https://software-carpentry.org/blog/2011/03/literate-programming.html</p>

<h3>Similar tools</h3>

<p>I stumbled across [ProjecturED](http://projectured.org/). It is similar to RLiterate in the sense that it is an editor for richer documents. Not just text. The most interesting aspect for me is that a variable name exists in one place, but can be rendered in multiple. So a rename is really simple. With RLiterate, you have to do a search and replace. But with ProjecturED you just change the name and it replicates everywhere. This is an attractive feature and is made possible by the different document model. Probably RLiterate can never support that because a completely different approach needs to be taken, but it is an interesting project to investigate further.
</p>

<h2>Implementation</h2>

<p>RLiterate is implemented in Python. This chapter gives a complete description of all the code.</p>

<h3>GUI wxPython</h3>

<p>The main GUI is written in wxPython.</p>

<h4>Main frame</h4>

<p>The main frame lays out two widgets horizontally: the table of contents and the workspace. It also creates the project from the specified file path.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">MainFrame</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Frame</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">filepath</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Frame</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">project</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">Project</span><span style="color: #657b83">(</span><span style="color: #657b83">filepath</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">workspace</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">Workspace</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">toc</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">TableOfContents</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">sizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">HORIZONTAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">toc</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">proportion</span><span style="color: #657b83">=</span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">workspace</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">proportion</span><span style="color: #657b83">=</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetSizerAndFit</span><span style="color: #657b83">(</span><span style="color: #657b83">sizer</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h4>Table of contents</h4>

<p>The table of contents shows the outline of the document. It allows only subtrees to be shown (hoisting) and allows subtrees to be expanded/collapsed. It also provides navigation functions to allow pages to be opened.</p>

<h5>Main widget</h5>

<p>The main table of contents widget listens for changes to a project (only events related to changes in the document and the layout of the table of contents) and then re-renders itself.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">TableOfContents</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">&lt;&lt;</span><span style="color: #657b83">TableOfContents</span><span style="color: #657b83">&gt;&gt;</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;TableOfContents&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">size</span><span style="color: #657b83">=</span><span style="color: #657b83">(</span><span style="color: #2aa198">250</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">-</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project_listener</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">Listener</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_re_render_from_event</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #2aa198">"</span><span style="color: #2aa198">document</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">layout.toc</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetProject</span><span style="color: #657b83">(</span><span style="color: #657b83">project</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">&lt;&lt;</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">&gt;&gt;</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">SetProject</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project_listener</span><span style="color: #657b83">.</span><span style="color: #657b83">set_observable</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p>This seems to be needed for some reason:</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;TableOfContents&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_re_render_from_event</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">CallAfter</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_re_render</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h6>Rendering</h6>

<p>The table of contents widget lays out two components in a vertical container: the unhoist button and the page container.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;TableOfContents&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">VERTICAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetSizer</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetBackgroundColour</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #2aa198">255</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">255</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">255</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_re_render</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_re_render</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">drop_points</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Clear</span><span style="color: #657b83">(</span><span style="color: #268bd2">True</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_unhoist_button</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_page_container</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Layout</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p>The unhoist button (only shown if a page has been hoisted):</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;TableOfContents&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_unhoist_button</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">get_hoisted_page</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">button</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Button</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">label</span><span style="color: #657b83">=</span><span style="color: #2aa198">"</span><span style="color: #2aa198">unhoist</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">button</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_BUTTON</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">set_hoisted_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">None</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">button</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p>The page container is a scrolling container that contains a set of rows representing pages. Each row is appropriately intendent to create the illusion of a tree.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;TableOfContents&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_page_container</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_sizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">VERTICAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_container</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">CompactScrolledWindow</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_container</span><span style="color: #657b83">.</span><span style="color: #657b83">SetSizer</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_sizer</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_container</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">proportion</span><span style="color: #657b83">=</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">get_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">get_hoisted_page</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">indentation</span><span style="color: #657b83">=</span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">is_collapsed</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">is_collapsed</span><span style="color: #657b83">(</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">TableOfContentsRow</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_container</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">indentation</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">divider</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">Divider</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_container</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">padding</span><span style="color: #657b83">=</span><span style="color: #2aa198">0</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">height</span><span style="color: #657b83">=</span><span style="color: #2aa198">2</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">divider</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">is_collapsed</span><span style="color: #657b83"> </span><span style="color: #859900">or</span><span style="color: #657b83"> </span><span style="color: #dc322f">len</span><span style="color: #657b83">(</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">children</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #2aa198">0</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">before_page_id</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">else</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">before_page_id</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">children</span><span style="color: #657b83">[</span><span style="color: #2aa198">0</span><span style="color: #657b83">]</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">drop_points</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">TableOfContentsDropPoint</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">divider</span><span style="color: #657b83">=</span><span style="color: #657b83">divider</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">indentation</span><span style="color: #657b83">=</span><span style="color: #657b83">indentation</span><span style="color: #657b83">+</span><span style="color: #2aa198">1</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">parent_page_id</span><span style="color: #657b83">=</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">before_page_id</span><span style="color: #657b83">=</span><span style="color: #657b83">before_page_id</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #657b83">is_collapsed</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">child</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">next_child</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">pairs</span><span style="color: #657b83">(</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">children</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">divider</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_page</span><span style="color: #657b83">(</span><span style="color: #657b83">child</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">indentation</span><span style="color: #657b83">+</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">drop_points</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">TableOfContentsDropPoint</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">divider</span><span style="color: #657b83">=</span><span style="color: #657b83">divider</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">indentation</span><span style="color: #657b83">=</span><span style="color: #657b83">indentation</span><span style="color: #657b83">+</span><span style="color: #2aa198">1</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">parent_page_id</span><span style="color: #657b83">=</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">before_page_id</span><span style="color: #657b83">=</span><span style="color: #268bd2">None</span><span style="color: #657b83"> </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">next_child</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83"> </span><span style="color: #859900">else</span><span style="color: #657b83"> </span><span style="color: #657b83">next_child</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">divider</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">TableOfContentsDropPoint</span><span style="color: #657b83">(</span><span style="color: #dc322f">object</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">divider</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">indentation</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent_page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">before_page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">divider</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">divider</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">indentation</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">indentation</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">parent_page_id</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">parent_page_id</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">before_page_id</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">before_page_id</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">x_distance_to</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">x</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">left_padding</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">TableOfContentsButton</span><span style="color: #657b83">.</span><span style="color: #657b83">SIZE</span><span style="color: #657b83">+</span><span style="color: #2aa198">1</span><span style="color: #657b83">+</span><span style="color: #657b83">TableOfContentsRow</span><span style="color: #657b83">.</span><span style="color: #657b83">BORDER</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">span_x_center</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">left_padding</span><span style="color: #657b83"> </span><span style="color: #657b83">+</span><span style="color: #657b83"> </span><span style="color: #657b83">TableOfContentsRow</span><span style="color: #657b83">.</span><span style="color: #657b83">INDENTATION_SIZE</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83"> </span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">indentation</span><span style="color: #657b83"> </span><span style="color: #657b83">+</span><span style="color: #657b83"> </span><span style="color: #2aa198">1.5</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #dc322f">abs</span><span style="color: #657b83">(</span><span style="color: #657b83">span_x_center</span><span style="color: #657b83"> </span><span style="color: #657b83">-</span><span style="color: #657b83"> </span><span style="color: #657b83">x</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">y_distance_to</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #dc322f">abs</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">divider</span><span style="color: #657b83">.</span><span style="color: #657b83">Position</span><span style="color: #657b83">.</span><span style="color: #657b83">y</span><span style="color: #657b83"> </span><span style="color: #657b83">+</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">divider</span><span style="color: #657b83">.</span><span style="color: #657b83">Size</span><span style="color: #657b83">[</span><span style="color: #2aa198">1</span><span style="color: #657b83">]</span><span style="color: #657b83">/</span><span style="color: #2aa198">2</span><span style="color: #657b83"> </span><span style="color: #657b83">-</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">Show</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">divider</span><span style="color: #657b83">.</span><span style="color: #657b83">Show</span><span style="color: #657b83">(</span><span style="color: #dc322f">sum</span><span style="color: #657b83">(</span><span style="color: #657b83">[</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">TableOfContentsRow</span><span style="color: #657b83">.</span><span style="color: #657b83">BORDER</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">TableOfContentsButton</span><span style="color: #657b83">.</span><span style="color: #657b83">SIZE</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #2aa198">1</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">indentation</span><span style="color: #657b83">*</span><span style="color: #657b83">TableOfContentsRow</span><span style="color: #657b83">.</span><span style="color: #657b83">INDENTATION_SIZE</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">]</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">Hide</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">divider</span><span style="color: #657b83">.</span><span style="color: #657b83">Hide</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h6>Dropping pages</h6>

<p>Inside the table of contents, pages can be dragged and drop. The drag is initiated in the row widget and handled in the table of contents widget.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;TableOfContents&gt;&gt; / &lt;&lt;__init__&gt;&gt;</code>

</p>

<pre><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetDropTarget</span><span style="color: #657b83">(</span><span style="color: #657b83">TableOfContentsDropTarget</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">TableOfContentsDropTarget</span><span style="color: #657b83">(</span><span style="color: #657b83">DropPointDropTarget</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">toc</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">DropPointDropTarget</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">toc</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">page</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnDataDropped</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">dropped_page</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">drop_point</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">move_page</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">page_id</span><span style="color: #657b83">=</span><span style="color: #657b83">dropped_page</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">page_id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">parent_page_id</span><span style="color: #657b83">=</span><span style="color: #657b83">drop_point</span><span style="color: #657b83">.</span><span style="color: #657b83">parent_page_id</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">before_page_id</span><span style="color: #657b83">=</span><span style="color: #657b83">drop_point</span><span style="color: #657b83">.</span><span style="color: #657b83">before_page_id</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p>The DropPointDropTarget requires FindClosestDropPoint to be defined on the target object. Here it is:</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;TableOfContents&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">FindClosestDropPoint</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">screen_pos</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">client_pos</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_container</span><span style="color: #657b83">.</span><span style="color: #657b83">ScreenToClient</span><span style="color: #657b83">(</span><span style="color: #657b83">screen_pos</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_container</span><span style="color: #657b83">.</span><span style="color: #657b83">HitTest</span><span style="color: #657b83">(</span><span style="color: #657b83">client_pos</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">HT_WINDOW_INSIDE</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">scroll_pos</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">(</span><span style="color: #657b83">scroll_x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">scroll_y</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_container</span><span style="color: #657b83">.</span><span style="color: #657b83">CalcUnscrolledPosition</span><span style="color: #657b83">(</span><span style="color: #657b83">client_pos</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">y_distances</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">defaultdict</span><span style="color: #657b83">(</span><span style="color: #dc322f">list</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">drop_point</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">drop_points</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">y_distances</span><span style="color: #657b83">[</span><span style="color: #657b83">drop_point</span><span style="color: #657b83">.</span><span style="color: #657b83">y_distance_to</span><span style="color: #657b83">(</span><span style="color: #657b83">scroll_y</span><span style="color: #657b83">)</span><span style="color: #657b83">]</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">drop_point</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">y_distances</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #dc322f">min</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">y_distances</span><span style="color: #657b83">[</span><span style="color: #dc322f">min</span><span style="color: #657b83">(</span><span style="color: #657b83">y_distances</span><span style="color: #657b83">.</span><span style="color: #657b83">keys</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">key</span><span style="color: #657b83">=</span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">drop_point</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">drop_point</span><span style="color: #657b83">.</span><span style="color: #657b83">x_distance_to</span><span style="color: #657b83">(</span><span style="color: #657b83">scroll_x</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h5>Row widget</h5>

<p>The row widget renders the page title at the appropriate indentation. If the page has children, an expand/collapse widget is also rendered to the left of the title.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">TableOfContentsRow</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">indentation</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">indentation</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">indentation</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">&lt;&lt;</span><span style="color: #657b83">TableOfContentsRow</span><span style="color: #657b83">&gt;&gt;</span><span style="color: #657b83">
</span></pre>

<p>Rendering lays out expand/collapse button (if the page has children) and the page title in a horizontal sizer:</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;TableOfContentsRow&gt;&gt;</code>

</p>

<pre><span style="color: #657b83">BORDER</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">2</span><span style="color: #657b83">
</span><span style="color: #657b83">INDENTATION_SIZE</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">16</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">HORIZONTAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">indentation</span><span style="color: #657b83">*</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">INDENTATION_SIZE</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">children</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">button</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">TableOfContentsButton</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">button</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">LEFT</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">BORDER</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">else</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #657b83">TableOfContentsButton</span><span style="color: #657b83">.</span><span style="color: #657b83">SIZE</span><span style="color: #657b83">+</span><span style="color: #2aa198">1</span><span style="color: #657b83">+</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">BORDER</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">text</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">StaticText</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">text</span><span style="color: #657b83">.</span><span style="color: #657b83">SetLabelText</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">title</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">text</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">ALL</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">BORDER</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetSizer</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_ENTER_WINDOW</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_on_enter_window</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_LEAVE_WINDOW</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_on_leave_window</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">helper</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">MouseEventHelper</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">MouseEventHelper</span><span style="color: #657b83">(</span><span style="color: #657b83">text</span><span style="color: #657b83">)</span><span style="color: #657b83">]</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">helper</span><span style="color: #657b83">.</span><span style="color: #657b83">OnClick</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_on_click</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">helper</span><span style="color: #657b83">.</span><span style="color: #657b83">OnDoubleClick</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_on_double_click</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">helper</span><span style="color: #657b83">.</span><span style="color: #657b83">OnRightClick</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_on_right_click</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">helper</span><span style="color: #657b83">.</span><span style="color: #657b83">OnDrag</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_on_drag</span><span style="color: #657b83">
</span></pre>

<p>Event handlers:</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;TableOfContentsRow&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_on_click</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">open_pages</span><span style="color: #657b83">(</span><span style="color: #657b83">[</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">column_index</span><span style="color: #657b83">=</span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_on_double_click</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">page_ids</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">child</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">get_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">)</span><span style="color: #657b83">.</span><span style="color: #657b83">children</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">page_ids</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">child</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">open_pages</span><span style="color: #657b83">(</span><span style="color: #657b83">page_ids</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">column_index</span><span style="color: #657b83">=</span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_on_right_click</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">menu</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">PageContextMenu</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">PopupMenu</span><span style="color: #657b83">(</span><span style="color: #657b83">menu</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">menu</span><span style="color: #657b83">.</span><span style="color: #657b83">Destroy</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_on_drag</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">data</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">RliterateDataObject</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">page</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #2aa198">"</span><span style="color: #2aa198">page_id</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">}</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">drag_source</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">DropSource</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">drag_source</span><span style="color: #657b83">.</span><span style="color: #657b83">SetData</span><span style="color: #657b83">(</span><span style="color: #657b83">data</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">result</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">drag_source</span><span style="color: #657b83">.</span><span style="color: #657b83">DoDragDrop</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Drag_DefaultMove</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_on_enter_window</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetBackgroundColour</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #2aa198">240</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">240</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">240</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_on_leave_window</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetBackgroundColour</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #2aa198">255</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">255</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">255</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h5>Expand/Collapse widget</h5>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">TableOfContentsButton</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">SIZE</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">16</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">size</span><span style="color: #657b83">=</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SIZE</span><span style="color: #657b83">+</span><span style="color: #2aa198">1</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">-</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_PAINT</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">OnPaint</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_LEFT_DOWN</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">OnLeftDown</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetCursor</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">StockCursor</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">CURSOR_HAND</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnLeftDown</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">toggle_collapsed</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnPaint</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">dc</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">GCDC</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">PaintDC</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">dc</span><span style="color: #657b83">.</span><span style="color: #657b83">SetBrush</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BLACK_BRUSH</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">render</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">RendererNative</span><span style="color: #657b83">.</span><span style="color: #657b83">Get</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">(</span><span style="color: #657b83">w</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">h</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Size</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">render</span><span style="color: #657b83">.</span><span style="color: #657b83">DrawTreeItemButton</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">dc</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">(</span><span style="color: #2aa198">0</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">(</span><span style="color: #657b83">h</span><span style="color: #657b83">-</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SIZE</span><span style="color: #657b83">)</span><span style="color: #657b83">/</span><span style="color: #2aa198">2</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SIZE</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SIZE</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">flags</span><span style="color: #657b83">=</span><span style="color: #2aa198">0</span><span style="color: #657b83"> </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">is_collapsed</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #859900">else</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">CONTROL_EXPANDED</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h5>Page context menu</h5>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">PageContextMenu</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Menu</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Menu</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">child_ids</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">]</span><span style="color: #657b83">+</span><span style="color: #657b83">[</span><span style="color: #657b83">child</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83"> </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">child</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">children</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_create_menu</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_create_menu</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_MENU</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">open_pages</span><span style="color: #657b83">(</span><span style="color: #657b83">[</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">column_index</span><span style="color: #657b83">=</span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Append</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">NewId</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">Open</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_MENU</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">open_pages</span><span style="color: #657b83">(</span><span style="color: #657b83">[</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">]</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Append</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">NewId</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">Open </span><span style="color: #2aa198">append</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_MENU</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">open_pages</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">child_ids</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">column_index</span><span style="color: #657b83">=</span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Append</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">NewId</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">Open </span><span style="color: #2aa198">with </span><span style="color: #2aa198">children</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_MENU</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">open_pages</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">child_ids</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Append</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">NewId</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">Open </span><span style="color: #2aa198">with </span><span style="color: #2aa198">children </span><span style="color: #2aa198">append</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">AppendSeparator</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_MENU</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">add_page</span><span style="color: #657b83">(</span><span style="color: #657b83">parent_id</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Append</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">NewId</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">Add </span><span style="color: #2aa198">child</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">AppendSeparator</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_MENU</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">set_hoisted_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Append</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">NewId</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">Hoist</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">AppendSeparator</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_MENU</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">delete_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Append</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">NewId</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">Delete</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h4>Workspace</h4>

<p>The workspace shows pages in the document. It is organized in columns, and each column can show multiple pages. The pages can also be edited from the workspace.</p>

<h5>Main widget</h5>

<p>The main workspace widget is a horizontal scrolling container containing column widgets.</p>

<p>The workspace is re-rendered whenever relevant parts of the project changes.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">Workspace</span><span style="color: #657b83">(</span><span style="color: #657b83">CompactScrolledWindow</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">&lt;&lt;</span><span style="color: #657b83">Workspace</span><span style="color: #657b83">&gt;&gt;</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Workspace&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">CompactScrolledWindow</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">style</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">HSCROLL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project_listener</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">Listener</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_re_render_from_event</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #2aa198">"</span><span style="color: #2aa198">document</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #2aa198">"</span><span style="color: #2aa198">layout.workspace</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetProject</span><span style="color: #657b83">(</span><span style="color: #657b83">project</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">&lt;&lt;</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">&gt;&gt;</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">SetProject</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project_listener</span><span style="color: #657b83">.</span><span style="color: #657b83">set_observable</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h6>Rendering</h6>

<p>Rendering a workspace means laying out a set of column widgets horizontally. Columns are filled with page containers.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Workspace&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetBackgroundColour</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #2aa198">200</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">200</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">200</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">HORIZONTAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">AddSpacer</span><span style="color: #657b83">(</span><span style="color: #657b83">PAGE_PADDING</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetSizer</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">columns</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_re_render</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_re_render</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_ensure_num_columns</span><span style="color: #657b83">(</span><span style="color: #dc322f">len</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">columns</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">index</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_ids</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #dc322f">enumerate</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">columns</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">columns</span><span style="color: #657b83">[</span><span style="color: #657b83">index</span><span style="color: #657b83">]</span><span style="color: #657b83">.</span><span style="color: #657b83">SetPages</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_ids</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Parent</span><span style="color: #657b83">.</span><span style="color: #657b83">Layout</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_ensure_num_columns</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">num</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">while</span><span style="color: #657b83"> </span><span style="color: #dc322f">len</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">columns</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #657b83">&gt;</span><span style="color: #657b83"> </span><span style="color: #657b83">num</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">columns</span><span style="color: #657b83">.</span><span style="color: #657b83">pop</span><span style="color: #657b83">(</span><span style="color: #657b83">-</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">.</span><span style="color: #657b83">Destroy</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">while</span><span style="color: #657b83"> </span><span style="color: #dc322f">len</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">columns</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #657b83">&lt;</span><span style="color: #657b83"> </span><span style="color: #657b83">num</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">columns</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_add_column</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_add_column</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">column</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">Column</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">column</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">column</span><span style="color: #657b83">
</span></pre>

<p>`Layout` is called on the parent. Otherwise scrollbars don't seem to update appropriately.</p>

<p>On removing widgets [Removing a widget from its wxPython parent](https://stackoverflow.com/a/41064558):</p>

<p>Widgets will remove themselves from the sizer when they are destroyed, so yes, it is redundant. Also, widgets will remove themselves from the parent's child list, so calling RemoveChild is also redundant. IOW, the call to window.Destroy() will be sufficient to remove the widget and its resources, and to do the necessary clean-ups in the parent and the sizer.</p>

<p>wx.CallAfter seems to be needed to correctly update scrollbars on an event notification. Resizing the window also works.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Workspace&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_re_render_from_event</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">CallAfter</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_re_render</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h6>Dropping paragraphs</h6>

<p>Inside a workspace, paragraphs can be dragged and dropped. The drag is handled in the paragraph widget, but the drop is handled in the workspace widget.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Workspace&gt;&gt; / &lt;&lt;__init__&gt;&gt;</code>

</p>

<pre><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetDropTarget</span><span style="color: #657b83">(</span><span style="color: #657b83">WorkspaceDropTarget</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">WorkspaceDropTarget</span><span style="color: #657b83">(</span><span style="color: #657b83">DropPointDropTarget</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">workspace</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">DropPointDropTarget</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">workspace</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">paragraph</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnDataDropped</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">dropped_paragraph</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">drop_point</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">move_paragraph</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">source_page</span><span style="color: #657b83">=</span><span style="color: #657b83">dropped_paragraph</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">page_id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">source_paragraph</span><span style="color: #657b83">=</span><span style="color: #657b83">dropped_paragraph</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">paragraph_id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">target_page</span><span style="color: #657b83">=</span><span style="color: #657b83">drop_point</span><span style="color: #657b83">.</span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">before_paragraph</span><span style="color: #657b83">=</span><span style="color: #657b83">drop_point</span><span style="color: #657b83">.</span><span style="color: #657b83">next_paragraph_id</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p>The DropPointDropTarget requires FindClosestDropPoint to be defined on the target object. Here it is:</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Workspace&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">FindClosestDropPoint</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">screen_pos</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">find_first</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">columns</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">column</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">column</span><span style="color: #657b83">.</span><span style="color: #657b83">FindClosestDropPoint</span><span style="color: #657b83">(</span><span style="color: #657b83">screen_pos</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h5>Column widget</h5>

<p>The column widget is a vertical scrolling container containing page containers.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">Column</span><span style="color: #657b83">(</span><span style="color: #657b83">CompactScrolledWindow</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">CompactScrolledWindow</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">style</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">VSCROLL</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">size</span><span style="color: #657b83">=</span><span style="color: #657b83">(</span><span style="color: #657b83">PAGE_BODY_WIDTH</span><span style="color: #657b83">+</span><span style="color: #2aa198">2</span><span style="color: #657b83">*</span><span style="color: #657b83">CONTAINER_BORDER</span><span style="color: #657b83">+</span><span style="color: #657b83">PAGE_PADDING</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">-</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_page_ids</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_setup_layout</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_setup_layout</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">VERTICAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetSizer</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">SetPages</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_ids</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">containers</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Clear</span><span style="color: #657b83">(</span><span style="color: #268bd2">True</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">AddSpacer</span><span style="color: #657b83">(</span><span style="color: #657b83">PAGE_PADDING</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">page_ids</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">container</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">PageContainer</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">container</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">RIGHT</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BOTTOM</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #657b83">PAGE_PADDING</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">containers</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">container</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">page_ids</span><span style="color: #657b83"> </span><span style="color: #657b83">!=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_page_ids</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Scroll</span><span style="color: #657b83">(</span><span style="color: #2aa198">0</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_page_ids</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">page_ids</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">FindClosestDropPoint</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">screen_pos</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">find_first</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">containers</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">container</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">container</span><span style="color: #657b83">.</span><span style="color: #657b83">FindClosestDropPoint</span><span style="color: #657b83">(</span><span style="color: #657b83">screen_pos</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h5>Page container widget</h5>

<p>The page container widget draws a box with border. Inside the box a page widget is rendered.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">PageContainer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_id</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetBackgroundColour</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #2aa198">150</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">150</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">150</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">inner_sizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">VERTICAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">inner_container</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">inner_container</span><span style="color: #657b83">.</span><span style="color: #657b83">SetBackgroundColour</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #2aa198">255</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">255</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">255</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">inner_container</span><span style="color: #657b83">.</span><span style="color: #657b83">SetSizer</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">inner_sizer</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">VERTICAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">inner_container</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">RIGHT</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BOTTOM</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #657b83">SHADOW_SIZE</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetSizer</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">inner_sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">AddSpacer</span><span style="color: #657b83">(</span><span style="color: #657b83">CONTAINER_BORDER</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">Page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">inner_container</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">inner_sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">LEFT</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">RIGHT</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BOTTOM</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #657b83">CONTAINER_BORDER</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">FindClosestDropPoint</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">screen_pos</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">FindClosestDropPoint</span><span style="color: #657b83">(</span><span style="color: #657b83">screen_pos</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h5>Page</h5>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">Page</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_id</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">&lt;&lt;</span><span style="color: #657b83">Page</span><span style="color: #657b83">&gt;&gt;</span><span style="color: #657b83">
</span></pre>

<h6>Rendering</h6>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Page&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">VERTICAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetSizer</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">drop_points</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">page</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">get_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">divider</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_paragraph</span><span style="color: #657b83">(</span><span style="color: #657b83">Title</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraphs</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">drop_points</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">PageDropPoint</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">divider</span><span style="color: #657b83">=</span><span style="color: #657b83">divider</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">page_id</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">next_paragraph_id</span><span style="color: #657b83">=</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">divider</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_paragraph</span><span style="color: #657b83">(</span><span style="color: #657b83">{</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #2aa198">"</span><span style="color: #2aa198">text</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">Paragraph</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #2aa198">"</span><span style="color: #2aa198">code</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">Code</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #2aa198">"</span><span style="color: #2aa198">factory</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">Factory</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">}</span><span style="color: #657b83">[</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">type</span><span style="color: #657b83">]</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">drop_points</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">PageDropPoint</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">divider</span><span style="color: #657b83">=</span><span style="color: #657b83">divider</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">page_id</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">next_paragraph_id</span><span style="color: #657b83">=</span><span style="color: #268bd2">None</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_add_button</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_paragraph</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #657b83">PARAGRAPH_SPACE</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">divider</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">Divider</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">padding</span><span style="color: #657b83">=</span><span style="color: #657b83">(</span><span style="color: #657b83">PARAGRAPH_SPACE</span><span style="color: #657b83">-</span><span style="color: #2aa198">3</span><span style="color: #657b83">)</span><span style="color: #657b83">/</span><span style="color: #2aa198">2</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">height</span><span style="color: #657b83">=</span><span style="color: #2aa198">3</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">divider</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #657b83">PARAGRAPH_SPACE</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">divider</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_add_button</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">add_button</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BitmapButton</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">bitmap</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">ArtProvider</span><span style="color: #657b83">.</span><span style="color: #657b83">GetBitmap</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">ART_ADD_BOOKMARK</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">ART_BUTTON</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">(</span><span style="color: #2aa198">16</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">16</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">style</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">NO_BORDER</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">add_button</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_BUTTON</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_on_add_button</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">add_button</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">TOP</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">ALIGN_RIGHT</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #657b83">PARAGRAPH_SPACE</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_on_add_button</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">add_paragraph</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">PageDropPoint</span><span style="color: #657b83">(</span><span style="color: #dc322f">object</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">divider</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">next_paragraph_id</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">divider</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">divider</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_id</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">next_paragraph_id</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">next_paragraph_id</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">y_distance_to</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #dc322f">abs</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">divider</span><span style="color: #657b83">.</span><span style="color: #657b83">Position</span><span style="color: #657b83">.</span><span style="color: #657b83">y</span><span style="color: #657b83"> </span><span style="color: #657b83">+</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">divider</span><span style="color: #657b83">.</span><span style="color: #657b83">Size</span><span style="color: #657b83">[</span><span style="color: #2aa198">1</span><span style="color: #657b83">]</span><span style="color: #657b83">/</span><span style="color: #2aa198">2</span><span style="color: #657b83"> </span><span style="color: #657b83">-</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">Show</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">divider</span><span style="color: #657b83">.</span><span style="color: #657b83">Show</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">Hide</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">divider</span><span style="color: #657b83">.</span><span style="color: #657b83">Hide</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h6>Dropping paragraphs</h6>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Page&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">FindClosestDropPoint</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">screen_pos</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">client_pos</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">(</span><span style="color: #657b83">client_x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">client_y</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">ScreenToClient</span><span style="color: #657b83">(</span><span style="color: #657b83">screen_pos</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">HitTest</span><span style="color: #657b83">(</span><span style="color: #657b83">client_pos</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">HT_WINDOW_INSIDE</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">min_or_none</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">drop_points</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">key</span><span style="color: #657b83">=</span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">drop_point</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">drop_point</span><span style="color: #657b83">.</span><span style="color: #657b83">y_distance_to</span><span style="color: #657b83">(</span><span style="color: #657b83">client_y</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h5>Title</h5>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">Title</span><span style="color: #657b83">(</span><span style="color: #657b83">Editable</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Editable</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">CreateView</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Font</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">create_font</span><span style="color: #657b83">(</span><span style="color: #657b83">size</span><span style="color: #657b83">=</span><span style="color: #2aa198">16</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">view</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">RichTextDisplay</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">Fragment</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">title</span><span style="color: #657b83">)</span><span style="color: #657b83">.</span><span style="color: #657b83">word_split</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">max_width</span><span style="color: #657b83">=</span><span style="color: #657b83">PAGE_BODY_WIDTH</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">view</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">CreateEdit</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">edit</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">TextCtrl</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">style</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">TE_PROCESS_ENTER</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">value</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">title</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">edit</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_TEXT_ENTER</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">_</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">EndEdit</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">edit</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">EndEdit</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">edit_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #2aa198">"</span><span style="color: #2aa198">title</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">edit</span><span style="color: #657b83">.</span><span style="color: #657b83">Value</span><span style="color: #657b83">}</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h5>Paragraphs</h5>

<h6>Text</h6>

<h7>Paragraph</h7>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">Paragraph</span><span style="color: #657b83">(</span><span style="color: #657b83">ParagraphBase</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">Editable</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">ParagraphBase</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Editable</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">CreateView</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">view</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">RichTextDisplay</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">formatted_text</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">line_height</span><span style="color: #657b83">=</span><span style="color: #2aa198">1.2</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">max_width</span><span style="color: #657b83">=</span><span style="color: #657b83">PAGE_BODY_WIDTH</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">MouseEventHelper</span><span style="color: #657b83">.</span><span style="color: #657b83">bind</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">[</span><span style="color: #657b83">view</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">drag</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">DoDragDrop</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">right_click</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">ShowContextMenu</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">move</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_change_cursor</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">click</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_follow_link</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">default_cursor</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">view</span><span style="color: #657b83">.</span><span style="color: #657b83">GetCursor</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">link_fragment</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">view</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_change_cursor</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">position</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">fragment</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">view</span><span style="color: #657b83">.</span><span style="color: #657b83">GetFragment</span><span style="color: #657b83">(</span><span style="color: #657b83">position</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">fragment</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83"> </span><span style="color: #859900">and</span><span style="color: #657b83"> </span><span style="color: #657b83">fragment</span><span style="color: #657b83">.</span><span style="color: #657b83">token</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">RLiterate</span><span style="color: #657b83">.</span><span style="color: #657b83">Link</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetCursor</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">StockCursor</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">CURSOR_HAND</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">link_fragment</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">fragment</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">else</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetCursor</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">default_cursor</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">link_fragment</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_follow_link</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">link_fragment</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">webbrowser</span><span style="color: #657b83">.</span><span style="color: #657b83">open</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">link_fragment</span><span style="color: #657b83">.</span><span style="color: #657b83">extra</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">url</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">CreateEdit</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">edit</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">TextCtrl</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">style</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">TE_MULTILINE</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">value</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #93a1a1"># </span><span style="color: #93a1a1">Error </span><span style="color: #93a1a1">is </span><span style="color: #93a1a1">printed </span><span style="color: #93a1a1">if </span><span style="color: #93a1a1">height </span><span style="color: #93a1a1">is </span><span style="color: #93a1a1">too </span><span style="color: #93a1a1">small:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #93a1a1"># </span><span style="color: #93a1a1">Gtk-CRITICAL </span><span style="color: #93a1a1">**: </span><span style="color: #93a1a1">gtk_box_gadget_distribute: </span><span style="color: #93a1a1">assertion </span><span style="color: #93a1a1">'size </span><span style="color: #93a1a1">&gt;= </span><span style="color: #93a1a1">0' </span><span style="color: #93a1a1">failed </span><span style="color: #93a1a1">in </span><span style="color: #93a1a1">GtkScrollbar</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #93a1a1"># </span><span style="color: #93a1a1">Solution: </span><span style="color: #93a1a1">Make </span><span style="color: #93a1a1">it </span><span style="color: #93a1a1">at </span><span style="color: #93a1a1">least </span><span style="color: #93a1a1">50 </span><span style="color: #93a1a1">heigh.</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">edit</span><span style="color: #657b83">.</span><span style="color: #657b83">MinSize</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">(</span><span style="color: #657b83">-</span><span style="color: #2aa198">1</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #dc322f">max</span><span style="color: #657b83">(</span><span style="color: #2aa198">50</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">view</span><span style="color: #657b83">.</span><span style="color: #657b83">Size</span><span style="color: #657b83">[</span><span style="color: #2aa198">1</span><span style="color: #657b83">]</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">edit</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">EndEdit</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">edit_paragraph</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #2aa198">"</span><span style="color: #2aa198">text</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">edit</span><span style="color: #657b83">.</span><span style="color: #657b83">Value</span><span style="color: #657b83">}</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h6>Code</h6>

<h7>Container widget</h7>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">Code</span><span style="color: #657b83">(</span><span style="color: #657b83">ParagraphBase</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">Editable</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">ParagraphBase</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Editable</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">CreateView</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">CodeView</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">CreateEdit</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">CodeEditor</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">view</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">EndEdit</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">edit_paragraph</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #2aa198">"</span><span style="color: #2aa198">path</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">edit</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">.</span><span style="color: #657b83">Value</span><span style="color: #657b83">.</span><span style="color: #657b83">split</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198"> / </span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #2aa198">"</span><span style="color: #2aa198">text</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">edit</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">.</span><span style="color: #657b83">Value</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">}</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h7>View widget</h7>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">CodeView</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">BORDER</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">0</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">PADDING</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">5</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">code_paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Font</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">create_font</span><span style="color: #657b83">(</span><span style="color: #657b83">monospace</span><span style="color: #657b83">=</span><span style="color: #268bd2">True</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">VERTICAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_create_path</span><span style="color: #657b83">(</span><span style="color: #657b83">code_paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">ALL</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">BORDER</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_create_code</span><span style="color: #657b83">(</span><span style="color: #657b83">code_paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">LEFT</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BOTTOM</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">RIGHT</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">BORDER</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetSizer</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetBackgroundColour</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #2aa198">243</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">236</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">219</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_create_path</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">code_paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">panel</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">panel</span><span style="color: #657b83">.</span><span style="color: #657b83">SetBackgroundColour</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #2aa198">248</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">241</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">223</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">text</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">RichTextDisplay</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">panel</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">insert_between</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">Fragment</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198"> / </span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">[</span><span style="color: #657b83">Fragment</span><span style="color: #657b83">(</span><span style="color: #657b83">x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">token</span><span style="color: #657b83">=</span><span style="color: #657b83">pygments</span><span style="color: #657b83">.</span><span style="color: #657b83">token</span><span style="color: #657b83">.</span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">RLiterate</span><span style="color: #657b83">.</span><span style="color: #657b83">Strong</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">x</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">code_paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">max_width</span><span style="color: #657b83">=</span><span style="color: #657b83">PAGE_BODY_WIDTH</span><span style="color: #657b83">-</span><span style="color: #2aa198">2</span><span style="color: #657b83">*</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">PADDING</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">sizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">HORIZONTAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">text</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">ALL</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">PADDING</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">panel</span><span style="color: #657b83">.</span><span style="color: #657b83">SetSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">sizer</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">MouseEventHelper</span><span style="color: #657b83">.</span><span style="color: #657b83">bind</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">[</span><span style="color: #657b83">panel</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">text</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">double_click</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_post_paragraph_edit_start</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">drag</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Parent</span><span style="color: #657b83">.</span><span style="color: #657b83">DoDragDrop</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">right_click</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Parent</span><span style="color: #657b83">.</span><span style="color: #657b83">ShowContextMenu</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">panel</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_create_code</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">code_paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">panel</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">panel</span><span style="color: #657b83">.</span><span style="color: #657b83">SetBackgroundColour</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #2aa198">253</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">246</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">227</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">body</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">RichTextDisplay</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">panel</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">code_paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">formatted_text</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">max_width</span><span style="color: #657b83">=</span><span style="color: #657b83">PAGE_BODY_WIDTH</span><span style="color: #657b83">-</span><span style="color: #2aa198">2</span><span style="color: #657b83">*</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">PADDING</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">sizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">HORIZONTAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">body</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">ALL</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">PADDING</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">proportion</span><span style="color: #657b83">=</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">panel</span><span style="color: #657b83">.</span><span style="color: #657b83">SetSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">sizer</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">MouseEventHelper</span><span style="color: #657b83">.</span><span style="color: #657b83">bind</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">[</span><span style="color: #657b83">panel</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">body</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">double_click</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_post_paragraph_edit_start</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">drag</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Parent</span><span style="color: #657b83">.</span><span style="color: #657b83">DoDragDrop</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">right_click</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Parent</span><span style="color: #657b83">.</span><span style="color: #657b83">ShowContextMenu</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">panel</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_post_paragraph_edit_start</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">PostEvent</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">ParagraphEditStart</span><span style="color: #657b83">(</span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;functions&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">insert_between</span><span style="color: #657b83">(</span><span style="color: #657b83">separator</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">items</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">result</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">i</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">item</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #dc322f">enumerate</span><span style="color: #657b83">(</span><span style="color: #657b83">items</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">i</span><span style="color: #657b83"> </span><span style="color: #657b83">&gt;</span><span style="color: #657b83"> </span><span style="color: #2aa198">0</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">result</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">separator</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">result</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">item</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">result</span><span style="color: #657b83">
</span></pre>

<h7>Editor widget</h7>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">CodeEditor</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">BORDER</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">1</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">PADDING</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">3</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">view</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">code_paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Font</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">create_font</span><span style="color: #657b83">(</span><span style="color: #657b83">monospace</span><span style="color: #657b83">=</span><span style="color: #268bd2">True</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">view</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">view</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">VERTICAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_create_path</span><span style="color: #657b83">(</span><span style="color: #657b83">code_paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">ALL</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">BORDER</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_create_code</span><span style="color: #657b83">(</span><span style="color: #657b83">code_paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">LEFT</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BOTTOM</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">RIGHT</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">BORDER</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_create_save</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">LEFT</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BOTTOM</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">RIGHT</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">BORDER</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetSizer</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_create_path</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">code_paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">TextCtrl</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">value</span><span style="color: #657b83">=</span><span style="color: #2aa198">"</span><span style="color: #2aa198"> / </span><span style="color: #2aa198">"</span><span style="color: #657b83">.</span><span style="color: #657b83">join</span><span style="color: #657b83">(</span><span style="color: #657b83">code_paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_create_code</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">code_paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">TextCtrl</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">style</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">TE_MULTILINE</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">value</span><span style="color: #657b83">=</span><span style="color: #657b83">code_paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #93a1a1"># </span><span style="color: #93a1a1">Error </span><span style="color: #93a1a1">is </span><span style="color: #93a1a1">printed </span><span style="color: #93a1a1">if </span><span style="color: #93a1a1">height </span><span style="color: #93a1a1">is </span><span style="color: #93a1a1">too </span><span style="color: #93a1a1">small:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #93a1a1"># </span><span style="color: #93a1a1">Gtk-CRITICAL </span><span style="color: #93a1a1">**: </span><span style="color: #93a1a1">gtk_box_gadget_distribute: </span><span style="color: #93a1a1">assertion </span><span style="color: #93a1a1">'size </span><span style="color: #93a1a1">&gt;= </span><span style="color: #93a1a1">0' </span><span style="color: #93a1a1">failed </span><span style="color: #93a1a1">in </span><span style="color: #93a1a1">GtkScrollbar</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #93a1a1"># </span><span style="color: #93a1a1">Solution: </span><span style="color: #93a1a1">Make </span><span style="color: #93a1a1">it </span><span style="color: #93a1a1">at </span><span style="color: #93a1a1">least </span><span style="color: #93a1a1">50 </span><span style="color: #93a1a1">heigh.</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">.</span><span style="color: #657b83">MinSize</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">(</span><span style="color: #657b83">-</span><span style="color: #2aa198">1</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #dc322f">max</span><span style="color: #657b83">(</span><span style="color: #2aa198">50</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">view</span><span style="color: #657b83">.</span><span style="color: #657b83">Size</span><span style="color: #657b83">[</span><span style="color: #2aa198">1</span><span style="color: #657b83">]</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_create_save</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">button</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Button</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">label</span><span style="color: #657b83">=</span><span style="color: #2aa198">"</span><span style="color: #2aa198">Save</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_BUTTON</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_post_paragraph_edit_end</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">button</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_post_paragraph_edit_end</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">PostEvent</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">ParagraphEditEnd</span><span style="color: #657b83">(</span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h6>Factory</h6>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">Factory</span><span style="color: #657b83">(</span><span style="color: #657b83">ParagraphBase</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">ParagraphBase</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">MouseEventHelper</span><span style="color: #657b83">.</span><span style="color: #657b83">bind</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">[</span><span style="color: #268bd2">self</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">drag</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">DoDragDrop</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">right_click</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">ShowContextMenu</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetBackgroundColour</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #2aa198">240</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">240</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">240</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">VERTICAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">hsizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">HORIZONTAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">StaticText</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">label</span><span style="color: #657b83">=</span><span style="color: #2aa198">"</span><span style="color: #2aa198">Factory</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">TOP</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">ALIGN_CENTER</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #657b83">PARAGRAPH_SPACE</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">hsizer</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">TOP</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">ALIGN_CENTER</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #657b83">PARAGRAPH_SPACE</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">text_button</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Button</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">label</span><span style="color: #657b83">=</span><span style="color: #2aa198">"</span><span style="color: #2aa198">Text</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">text_button</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_BUTTON</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">OnTextButton</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">hsizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">text_button</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">ALL</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #2aa198">2</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">code_button</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Button</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">label</span><span style="color: #657b83">=</span><span style="color: #2aa198">"</span><span style="color: #2aa198">Code</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">code_button</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_BUTTON</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">OnCodeButton</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">hsizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">code_button</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">ALL</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">border</span><span style="color: #657b83">=</span><span style="color: #2aa198">2</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83">.</span><span style="color: #657b83">AddSpacer</span><span style="color: #657b83">(</span><span style="color: #657b83">PARAGRAPH_SPACE</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetSizer</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnTextButton</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">edit_paragraph</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #2aa198">"</span><span style="color: #2aa198">type</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">text</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">text</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">Enter </span><span style="color: #2aa198">text </span><span style="color: #2aa198">here...</span><span style="color: #2aa198">"</span><span style="color: #657b83">}</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnCodeButton</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">edit_paragraph</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #2aa198">"</span><span style="color: #2aa198">type</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">code</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">path</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">text</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">Enter </span><span style="color: #2aa198">code </span><span style="color: #2aa198">here...</span><span style="color: #2aa198">"</span><span style="color: #657b83">}</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h6>Common</h6>

<h7>Paragraph base</h7>

<p><code>rliterate.py / &lt;&lt;base classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">ParagraphBase</span><span style="color: #657b83">(</span><span style="color: #dc322f">object</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_id</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraph</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">DoDragDrop</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">data</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">RliterateDataObject</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">paragraph</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #2aa198">"</span><span style="color: #2aa198">page_id</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #2aa198">"</span><span style="color: #2aa198">paragraph_id</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">}</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">drag_source</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">DropSource</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">drag_source</span><span style="color: #657b83">.</span><span style="color: #657b83">SetData</span><span style="color: #657b83">(</span><span style="color: #657b83">data</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">result</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">drag_source</span><span style="color: #657b83">.</span><span style="color: #657b83">DoDragDrop</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Drag_DefaultMove</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">ShowContextMenu</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">menu</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">ParagraphContextMenu</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">PopupMenu</span><span style="color: #657b83">(</span><span style="color: #657b83">menu</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">menu</span><span style="color: #657b83">.</span><span style="color: #657b83">Destroy</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h7>Paragraph context menu</h7>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">ParagraphContextMenu</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Menu</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Menu</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_id</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraph</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_create_menu</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_create_menu</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_MENU</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">delete_paragraph</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">page_id</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">paragraph_id</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Append</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">NewId</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">Delete</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_MENU</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">edit_paragraph</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">{</span><span style="color: #2aa198">"</span><span style="color: #2aa198">text</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">edit_in_gvim</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">filename</span><span style="color: #657b83">)</span><span style="color: #657b83">}</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Append</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">NewId</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">Edit </span><span style="color: #2aa198">in </span><span style="color: #2aa198">gvim</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h7>Editable</h7>

<p><code>rliterate.py / &lt;&lt;base classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">Editable</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">view</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">CreateView</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">VERTICAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">view</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">proportion</span><span style="color: #657b83">=</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetSizer</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">view</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_LEFT_DCLICK</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">OnParagraphEditStart</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">view</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">EVT_PARAGRAPH_EDIT_START</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">OnParagraphEditStart</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnParagraphEditStart</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">edit</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">CreateEdit</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">edit</span><span style="color: #657b83">.</span><span style="color: #657b83">SetFocus</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">edit</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_CHAR</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">OnChar</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">edit</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">EVT_PARAGRAPH_EDIT_END</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">OnParagraphEditEnd</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">edit</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">proportion</span><span style="color: #657b83">=</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">sizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Hide</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">view</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">GetTopLevelParent</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">.</span><span style="color: #657b83">Layout</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnParagraphEditEnd</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">EndEdit</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnChar</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">.</span><span style="color: #657b83">KeyCode</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">WXK_CONTROL_S</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">OnParagraphEditEnd</span><span style="color: #657b83">(</span><span style="color: #268bd2">None</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">elif</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">.</span><span style="color: #657b83">KeyCode</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">WXK_RETURN</span><span style="color: #657b83"> </span><span style="color: #859900">and</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">.</span><span style="color: #657b83">ControlDown</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">OnParagraphEditEnd</span><span style="color: #657b83">(</span><span style="color: #268bd2">None</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">else</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">event</span><span style="color: #657b83">.</span><span style="color: #657b83">Skip</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h4>Drag &amp; drop</h4>

<h5>RLiterate data object</h5>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">RliterateDataObject</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">CustomDataObject</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">kind</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">json</span><span style="color: #657b83">=</span><span style="color: #268bd2">None</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">CustomDataObject</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">rliterate/{}</span><span style="color: #2aa198">"</span><span style="color: #657b83">.</span><span style="color: #657b83">format</span><span style="color: #657b83">(</span><span style="color: #657b83">kind</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">json</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">set_json</span><span style="color: #657b83">(</span><span style="color: #657b83">json</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">set_json</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">data</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetData</span><span style="color: #657b83">(</span><span style="color: #657b83">json</span><span style="color: #657b83">.</span><span style="color: #657b83">dumps</span><span style="color: #657b83">(</span><span style="color: #657b83">data</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">get_json</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">json</span><span style="color: #657b83">.</span><span style="color: #657b83">loads</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">GetData</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h5>Drop point drop target</h5>

<p>A drop target that can work with windows that supports FindClosestDropPoint.</p>

<p><code>rliterate.py / &lt;&lt;base classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">DropPointDropTarget</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">DropTarget</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">window</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">kind</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">DropTarget</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">window</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">window</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">last_drop_point</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">rliterate_data</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">RliterateDataObject</span><span style="color: #657b83">(</span><span style="color: #657b83">kind</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">DataObject</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">rliterate_data</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnDragOver</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">defResult</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_hide_last_drop_point</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">drop_point</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_find_closest_drop_point</span><span style="color: #657b83">(</span><span style="color: #657b83">x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">drop_point</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83"> </span><span style="color: #859900">and</span><span style="color: #657b83"> </span><span style="color: #657b83">defResult</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">DragMove</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">drop_point</span><span style="color: #657b83">.</span><span style="color: #657b83">Show</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">last_drop_point</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">drop_point</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">DragMove</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">DragNone</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnData</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">defResult</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_hide_last_drop_point</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">drop_point</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_find_closest_drop_point</span><span style="color: #657b83">(</span><span style="color: #657b83">x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">drop_point</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83"> </span><span style="color: #859900">and</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">GetData</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">OnDataDropped</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">rliterate_data</span><span style="color: #657b83">.</span><span style="color: #657b83">get_json</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">drop_point</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">defResult</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnLeave</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_hide_last_drop_point</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_find_closest_drop_point</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">window</span><span style="color: #657b83">.</span><span style="color: #657b83">FindClosestDropPoint</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">window</span><span style="color: #657b83">.</span><span style="color: #657b83">ClientToScreen</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #657b83">x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_hide_last_drop_point</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">last_drop_point</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">last_drop_point</span><span style="color: #657b83">.</span><span style="color: #657b83">Hide</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">last_drop_point</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">
</span></pre>

<h5>Divider</h5>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">Divider</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">padding</span><span style="color: #657b83">=</span><span style="color: #2aa198">0</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">height</span><span style="color: #657b83">=</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">size</span><span style="color: #657b83">=</span><span style="color: #657b83">(</span><span style="color: #657b83">-</span><span style="color: #2aa198">1</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">height</span><span style="color: #657b83">+</span><span style="color: #2aa198">2</span><span style="color: #657b83">*</span><span style="color: #657b83">padding</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">line</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">size</span><span style="color: #657b83">=</span><span style="color: #657b83">(</span><span style="color: #657b83">-</span><span style="color: #2aa198">1</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">height</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">line</span><span style="color: #657b83">.</span><span style="color: #657b83">SetBackgroundColour</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #2aa198">255</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">100</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">line</span><span style="color: #657b83">.</span><span style="color: #657b83">Hide</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">hsizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">HORIZONTAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">BoxSizer</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">VERTICAL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83">.</span><span style="color: #657b83">AddStretchSpacer</span><span style="color: #657b83">(</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">hsizer</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">|</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">RESERVE_SPACE_EVEN_IF_HIDDEN</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83">.</span><span style="color: #657b83">AddStretchSpacer</span><span style="color: #657b83">(</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetSizer</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">vsizer</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">Show</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">left_space</span><span style="color: #657b83">=</span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">line</span><span style="color: #657b83">.</span><span style="color: #657b83">Show</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">hsizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Clear</span><span style="color: #657b83">(</span><span style="color: #268bd2">False</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">hsizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #657b83">left_space</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">hsizer</span><span style="color: #657b83">.</span><span style="color: #657b83">Add</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">line</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flag</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EXPAND</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">proportion</span><span style="color: #657b83">=</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Layout</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">Hide</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">line</span><span style="color: #657b83">.</span><span style="color: #657b83">Hide</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Layout</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h4>wxPython utilities</h4>

<h5>Mouse event helper</h5>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">MouseEventHelper</span><span style="color: #657b83">(</span><span style="color: #dc322f">object</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@classmethod</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">bind</span><span style="color: #657b83">(</span><span style="color: #268bd2">cls</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">windows</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">drag</span><span style="color: #657b83">=</span><span style="color: #268bd2">None</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">click</span><span style="color: #657b83">=</span><span style="color: #268bd2">None</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">right_click</span><span style="color: #657b83">=</span><span style="color: #268bd2">None</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">             </span><span style="color: #657b83">double_click</span><span style="color: #657b83">=</span><span style="color: #268bd2">None</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">move</span><span style="color: #657b83">=</span><span style="color: #268bd2">None</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">window</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">windows</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">mouse_event_helper</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">cls</span><span style="color: #657b83">(</span><span style="color: #657b83">window</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">drag</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">mouse_event_helper</span><span style="color: #657b83">.</span><span style="color: #657b83">OnDrag</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">drag</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">click</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">mouse_event_helper</span><span style="color: #657b83">.</span><span style="color: #657b83">OnClick</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">click</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">right_click</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">mouse_event_helper</span><span style="color: #657b83">.</span><span style="color: #657b83">OnRightClick</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">right_click</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">double_click</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">mouse_event_helper</span><span style="color: #657b83">.</span><span style="color: #657b83">OnDoubleClick</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">double_click</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">move</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">mouse_event_helper</span><span style="color: #657b83">.</span><span style="color: #657b83">OnMove</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">move</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">window</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">down_pos</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">window</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_LEFT_DOWN</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_on_left_down</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">window</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_MOTION</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_on_motion</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">window</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_LEFT_UP</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_on_left_up</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">window</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_LEFT_DCLICK</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_on_left_dclick</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">window</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_RIGHT_UP</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_on_right_up</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnDrag</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">pass</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnClick</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">pass</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnRightClick</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">pass</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnDoubleClick</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">pass</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">OnMove</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">position</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">pass</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_on_left_down</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">down_pos</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">.</span><span style="color: #657b83">Position</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_on_motion</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">down_pos</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">OnMove</span><span style="color: #657b83">(</span><span style="color: #657b83">event</span><span style="color: #657b83">.</span><span style="color: #657b83">Position</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_should_drag</span><span style="color: #657b83">(</span><span style="color: #657b83">event</span><span style="color: #657b83">.</span><span style="color: #657b83">Position</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">down_pos</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">OnDrag</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_should_drag</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">pos</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">down_pos</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">diff</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">down_pos</span><span style="color: #657b83"> </span><span style="color: #657b83">-</span><span style="color: #657b83"> </span><span style="color: #657b83">pos</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #dc322f">abs</span><span style="color: #657b83">(</span><span style="color: #657b83">diff</span><span style="color: #657b83">.</span><span style="color: #657b83">x</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #657b83">&gt;</span><span style="color: #657b83"> </span><span style="color: #2aa198">2</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">True</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #dc322f">abs</span><span style="color: #657b83">(</span><span style="color: #657b83">diff</span><span style="color: #657b83">.</span><span style="color: #657b83">y</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #657b83">&gt;</span><span style="color: #657b83"> </span><span style="color: #2aa198">2</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">True</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">False</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_on_left_up</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">down_pos</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">OnClick</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">down_pos</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_on_left_dclick</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">OnDoubleClick</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_on_right_up</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">OnRightClick</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h5>Rich text display</h5>

<p>The rich text display widget displayes styled text fragments. It does so by drawing text on a DC.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">RichTextDisplay</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">&lt;&lt;</span><span style="color: #657b83">RichTextDisplay</span><span style="color: #657b83">&gt;&gt;</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;RichTextDisplay&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">fragments</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Panel</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">fragments</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">fragments</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">line_height</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">kwargs</span><span style="color: #657b83">.</span><span style="color: #657b83">get</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">line_height</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">max_width</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">kwargs</span><span style="color: #657b83">.</span><span style="color: #657b83">get</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">max_width</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">100</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">&lt;&lt;</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">&gt;&gt;</span><span style="color: #657b83">
</span></pre>

<p>First, the text fragment positions are calculated. For that a DC is needed. But the positions need to be calculated before we can draw on the panel, so a temporary memory DC is created.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;RichTextDisplay&gt;&gt; / &lt;&lt;__init__&gt;&gt;</code>

</p>

<pre><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_set_fragments</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;RichTextDisplay&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_set_fragments</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">dc</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">MemoryDC</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">dc</span><span style="color: #657b83">.</span><span style="color: #657b83">SetFont</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">GetFont</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">dc</span><span style="color: #657b83">.</span><span style="color: #657b83">SelectObject</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EmptyBitmap</span><span style="color: #657b83">(</span><span style="color: #2aa198">1</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">w</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">h</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_calculate_fragments</span><span style="color: #657b83">(</span><span style="color: #657b83">dc</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetMinSize</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #657b83">w</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">h</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_calculate_fragments</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">dc</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">draw_fragments</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">x</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">0</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">y</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">0</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">max_x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">max_y</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">dc</span><span style="color: #657b83">.</span><span style="color: #657b83">GetTextExtent</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">M</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">fragment</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_newline_fragments</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">fragment</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">x</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">0</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">y</span><span style="color: #657b83"> </span><span style="color: #657b83">+</span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #dc322f">int</span><span style="color: #657b83">(</span><span style="color: #dc322f">round</span><span style="color: #657b83">(</span><span style="color: #657b83">dc</span><span style="color: #657b83">.</span><span style="color: #657b83">GetTextExtent</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">M</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">[</span><span style="color: #2aa198">1</span><span style="color: #657b83">]</span><span style="color: #657b83">*</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">line_height</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">continue</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">style</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">get_style</span><span style="color: #657b83">(</span><span style="color: #657b83">fragment</span><span style="color: #657b83">.</span><span style="color: #657b83">token</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">style</span><span style="color: #657b83">.</span><span style="color: #657b83">apply_to_wx_dc</span><span style="color: #657b83">(</span><span style="color: #657b83">dc</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">GetFont</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">w</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">h</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">dc</span><span style="color: #657b83">.</span><span style="color: #657b83">GetTextExtent</span><span style="color: #657b83">(</span><span style="color: #657b83">fragment</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">x</span><span style="color: #657b83"> </span><span style="color: #657b83">&gt;</span><span style="color: #657b83"> </span><span style="color: #2aa198">0</span><span style="color: #657b83"> </span><span style="color: #859900">and</span><span style="color: #657b83"> </span><span style="color: #657b83">x</span><span style="color: #657b83">+</span><span style="color: #657b83">w</span><span style="color: #657b83"> </span><span style="color: #657b83">&gt;</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">max_width</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">x</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">0</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">y</span><span style="color: #657b83"> </span><span style="color: #657b83">+</span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #dc322f">int</span><span style="color: #657b83">(</span><span style="color: #dc322f">round</span><span style="color: #657b83">(</span><span style="color: #657b83">dc</span><span style="color: #657b83">.</span><span style="color: #657b83">GetTextExtent</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">M</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">[</span><span style="color: #2aa198">1</span><span style="color: #657b83">]</span><span style="color: #657b83">*</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">line_height</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">draw_fragments</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #657b83">fragment</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">style</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Rect</span><span style="color: #657b83">(</span><span style="color: #657b83">x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">w</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">h</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">max_x</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #dc322f">max</span><span style="color: #657b83">(</span><span style="color: #657b83">max_x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">x</span><span style="color: #657b83">+</span><span style="color: #657b83">w</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">max_y</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #dc322f">max</span><span style="color: #657b83">(</span><span style="color: #657b83">max_y</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">+</span><span style="color: #657b83">h</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">x</span><span style="color: #657b83"> </span><span style="color: #657b83">+</span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">w</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">(</span><span style="color: #657b83">max_x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">max_y</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_newline_fragments</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">fragment</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">fragments</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">fragment</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">x</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">insert_between</span><span style="color: #657b83">(</span><span style="color: #268bd2">None</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">fragment</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">.</span><span style="color: #657b83">split</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #859900">yield</span><span style="color: #657b83"> </span><span style="color: #657b83">Fragment</span><span style="color: #657b83">(</span><span style="color: #657b83">x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">token</span><span style="color: #657b83">=</span><span style="color: #657b83">fragment</span><span style="color: #657b83">.</span><span style="color: #657b83">token</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">else</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">yield</span><span style="color: #657b83"> </span><span style="color: #657b83">fragment</span><span style="color: #657b83">
</span></pre>

<p>Drawing the rich text is just a matter of drawing all fragments at the pre-calculated positions:</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;RichTextDisplay&gt;&gt; / &lt;&lt;__init__&gt;&gt;</code>

</p>

<pre><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_PAINT</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_on_paint</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;RichTextDisplay&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_on_paint</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">dc</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">PaintDC</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">fragment</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">style</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">box</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">draw_fragments</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">style</span><span style="color: #657b83">.</span><span style="color: #657b83">apply_to_wx_dc</span><span style="color: #657b83">(</span><span style="color: #657b83">dc</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">GetFont</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">dc</span><span style="color: #657b83">.</span><span style="color: #657b83">DrawText</span><span style="color: #657b83">(</span><span style="color: #657b83">fragment</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">box</span><span style="color: #657b83">.</span><span style="color: #657b83">X</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">box</span><span style="color: #657b83">.</span><span style="color: #657b83">Y</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p>Some mouse move action:</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;RichTextDisplay&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">GetFragment</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">position</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">fragment</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">style</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">box</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">draw_fragments</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">box</span><span style="color: #657b83">.</span><span style="color: #657b83">Contains</span><span style="color: #657b83">(</span><span style="color: #657b83">position</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">fragment</span><span style="color: #657b83">
</span></pre>

<h5>Scrolling containers</h5>

<p>The default scrolling window gives extra space. See https://stackoverflow.com/a/22817659. This custom control sovles this problem.</p>

<p><code>rliterate.py / &lt;&lt;base classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">CompactScrolledWindow</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">ScrolledWindow</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">MIN_WIDTH</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">200</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">MIN_HEIGHT</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">200</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">style</span><span style="color: #657b83">=</span><span style="color: #2aa198">0</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">size</span><span style="color: #657b83">=</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">DefaultSize</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">step</span><span style="color: #657b83">=</span><span style="color: #2aa198">100</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">w</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">h</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">size</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">size</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">(</span><span style="color: #dc322f">max</span><span style="color: #657b83">(</span><span style="color: #657b83">w</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">MIN_WIDTH</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #dc322f">max</span><span style="color: #657b83">(</span><span style="color: #657b83">h</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">MIN_HEIGHT</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">ScrolledWindow</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">style</span><span style="color: #657b83">=</span><span style="color: #657b83">style</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">size</span><span style="color: #657b83">=</span><span style="color: #657b83">size</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Size</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">size</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">style</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">HSCROLL</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetScrollRate</span><span style="color: #657b83">(</span><span style="color: #2aa198">1</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_calc_scroll_pos</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_calc_scroll_pos_hscroll</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">elif</span><span style="color: #657b83"> </span><span style="color: #657b83">style</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">VSCROLL</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetScrollRate</span><span style="color: #657b83">(</span><span style="color: #2aa198">0</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_calc_scroll_pos</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_calc_scroll_pos_vscroll</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">else</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">SetScrollRate</span><span style="color: #657b83">(</span><span style="color: #2aa198">1</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_calc_scroll_pos</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_calc_scroll_pos_vscroll</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">step</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">step</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Bind</span><span style="color: #657b83">(</span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">EVT_MOUSEWHEEL</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_on_mousewheel</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_on_mousewheel</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">GetViewStart</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">delta</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">.</span><span style="color: #657b83">GetWheelRotation</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #657b83">/</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">.</span><span style="color: #657b83">GetWheelDelta</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">Scroll</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_calc_scroll_pos</span><span style="color: #657b83">(</span><span style="color: #657b83">x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">delta</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_calc_scroll_pos_hscroll</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">delta</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">(</span><span style="color: #657b83">x</span><span style="color: #657b83">+</span><span style="color: #657b83">delta</span><span style="color: #657b83">*</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">step</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_calc_scroll_pos_vscroll</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">delta</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">(</span><span style="color: #657b83">x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">y</span><span style="color: #657b83">-</span><span style="color: #657b83">delta</span><span style="color: #657b83">*</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">step</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p>The minimum size is set to prevent the following error:</p>

<p>(rliterate.py:23983): Gtk-CRITICAL **: gtk_box_gadget_distribute: assertion 'size >= 0' failed in GtkScrollbar</p>

<h4>Constants</h4>

<p><code>rliterate.py / &lt;&lt;constants&gt;&gt;</code>

</p>

<pre><span style="color: #657b83">PAGE_BODY_WIDTH</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">600</span><span style="color: #657b83">
</span><span style="color: #657b83">PAGE_PADDING</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">13</span><span style="color: #657b83">
</span><span style="color: #657b83">SHADOW_SIZE</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">2</span><span style="color: #657b83">
</span><span style="color: #657b83">PARAGRAPH_SPACE</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">15</span><span style="color: #657b83">
</span><span style="color: #657b83">CONTAINER_BORDER</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">PARAGRAPH_SPACE</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">ParagraphEditStart</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">EVT_PARAGRAPH_EDIT_START</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">lib</span><span style="color: #657b83">.</span><span style="color: #657b83">newevent</span><span style="color: #657b83">.</span><span style="color: #657b83">NewCommandEvent</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">ParagraphEditEnd</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">EVT_PARAGRAPH_EDIT_END</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">lib</span><span style="color: #657b83">.</span><span style="color: #657b83">newevent</span><span style="color: #657b83">.</span><span style="color: #657b83">NewCommandEvent</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h3>Project</h3>

<p>A project is a container for a few other objects:</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">Project</span><span style="color: #657b83">(</span><span style="color: #657b83">Observable</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">filepath</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Observable</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">theme</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">SolarizedTheme</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">Document</span><span style="color: #657b83">.</span><span style="color: #657b83">from_file</span><span style="color: #657b83">(</span><span style="color: #657b83">filepath</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">.</span><span style="color: #657b83">listen</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">notify_forwarder</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">document</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">layout</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">Layout</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">.{}.layout</span><span style="color: #2aa198">"</span><span style="color: #657b83">.</span><span style="color: #657b83">format</span><span style="color: #657b83">(</span><span style="color: #657b83">filepath</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">layout</span><span style="color: #657b83">.</span><span style="color: #657b83">listen</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">notify_forwarder</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">layout</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">FileGenerator</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">.</span><span style="color: #657b83">set_document</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">MarkdownGenerator</span><span style="color: #657b83">(</span><span style="color: #657b83">os</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">.</span><span style="color: #657b83">splitext</span><span style="color: #657b83">(</span><span style="color: #657b83">filepath</span><span style="color: #657b83">)</span><span style="color: #657b83">[</span><span style="color: #2aa198">0</span><span style="color: #657b83">]</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198">.markdown</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">.</span><span style="color: #657b83">set_document</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">HTMLGenerator</span><span style="color: #657b83">(</span><span style="color: #657b83">os</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">.</span><span style="color: #657b83">splitext</span><span style="color: #657b83">(</span><span style="color: #657b83">filepath</span><span style="color: #657b83">)</span><span style="color: #657b83">[</span><span style="color: #2aa198">0</span><span style="color: #657b83">]</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198">.html</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">.</span><span style="color: #657b83">set_project</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">TextDiff</span><span style="color: #657b83">(</span><span style="color: #657b83">os</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">.</span><span style="color: #657b83">splitext</span><span style="color: #657b83">(</span><span style="color: #657b83">filepath</span><span style="color: #657b83">)</span><span style="color: #657b83">[</span><span style="color: #2aa198">0</span><span style="color: #657b83">]</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198">.textdiff</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">.</span><span style="color: #657b83">set_document</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">&lt;&lt;</span><span style="color: #657b83">Project</span><span style="color: #657b83">&gt;&gt;</span><span style="color: #657b83">
</span></pre>

<p>Wrapper methods for layout:</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Project&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">toggle_collapsed</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">layout</span><span style="color: #657b83">.</span><span style="color: #657b83">toggle_collapsed</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">is_collapsed</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">layout</span><span style="color: #657b83">.</span><span style="color: #657b83">is_collapsed</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">get_scratch_pages</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">layout</span><span style="color: #657b83">.</span><span style="color: #657b83">get_scratch_pages</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">set_scratch_pages</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">layout</span><span style="color: #657b83">.</span><span style="color: #657b83">set_scratch_pages</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #268bd2">@property</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">columns</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">layout</span><span style="color: #657b83">.</span><span style="color: #657b83">columns</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">open_pages</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">layout</span><span style="color: #657b83">.</span><span style="color: #657b83">open_pages</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">get_hoisted_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">layout</span><span style="color: #657b83">.</span><span style="color: #657b83">get_hoisted_page</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">set_hoisted_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">layout</span><span style="color: #657b83">.</span><span style="color: #657b83">set_hoisted_page</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p>Wrapper methods for document:</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Project&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">get_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">.</span><span style="color: #657b83">get_page</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">add_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">.</span><span style="color: #657b83">add_page</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">delete_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">.</span><span style="color: #657b83">delete_page</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">move_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">.</span><span style="color: #657b83">move_page</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">edit_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">.</span><span style="color: #657b83">edit_page</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">add_paragraph</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">.</span><span style="color: #657b83">add_paragraph</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">move_paragraph</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">.</span><span style="color: #657b83">move_paragraph</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">delete_paragraph</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">.</span><span style="color: #657b83">delete_paragraph</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">edit_paragraph</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">.</span><span style="color: #657b83">edit_paragraph</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p>Wrapper for theme:</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Project&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">get_style</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">theme</span><span style="color: #657b83">.</span><span style="color: #657b83">get_style</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">args</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">kwargs</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h4>Document model</h4>

<h5>Document</h5>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">Document</span><span style="color: #657b83">(</span><span style="color: #657b83">Observable</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@classmethod</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">from_file</span><span style="color: #657b83">(</span><span style="color: #268bd2">cls</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">cls</span><span style="color: #657b83">(</span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Observable</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">path</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_load</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_cache</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">listen</span><span style="color: #657b83">(</span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_save</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_cache</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_pages</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #657b83">}</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_parent_pages</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #657b83">}</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_paragraphs</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #657b83">}</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_cache_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">root_page</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_cache_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent_page</span><span style="color: #657b83">=</span><span style="color: #268bd2">None</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">page</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">]</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_parent_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">page</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">]</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">parent_page</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">paragraphs</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_paragraphs</span><span style="color: #657b83">[</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">]</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">child</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">children</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_cache_page</span><span style="color: #657b83">(</span><span style="color: #657b83">child</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_save</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">write_json_to_file</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">root_page</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_load</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">root_page</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">load_json_from_file</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">&lt;&lt;</span><span style="color: #657b83">Document</span><span style="color: #657b83">&gt;&gt;</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #93a1a1"># </span><span style="color: #93a1a1">Page </span><span style="color: #93a1a1">operations</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">add_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">title</span><span style="color: #657b83">=</span><span style="color: #2aa198">"</span><span style="color: #2aa198">New </span><span style="color: #2aa198">page</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent_id</span><span style="color: #657b83">=</span><span style="color: #268bd2">None</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">notify</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">page</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #2aa198">"</span><span style="color: #2aa198">id</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">genid</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #2aa198">"</span><span style="color: #2aa198">title</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">New </span><span style="color: #2aa198">page...</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #2aa198">"</span><span style="color: #2aa198">children</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #2aa198">"</span><span style="color: #2aa198">paragraphs</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">}</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">parent_page</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">parent_id</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">parent_page</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">children</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">page</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">page</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">]</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_parent_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">page</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">]</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">parent_page</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">delete_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">notify</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">page</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">page_id</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">parent_page</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_parent_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">page_id</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">index</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">index_with_id</span><span style="color: #657b83">(</span><span style="color: #657b83">parent_page</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">children</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">parent_page</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">children</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">.</span><span style="color: #657b83">pop</span><span style="color: #657b83">(</span><span style="color: #657b83">index</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_pages</span><span style="color: #657b83">.</span><span style="color: #657b83">pop</span><span style="color: #657b83">(</span><span style="color: #657b83">page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_parent_pages</span><span style="color: #657b83">.</span><span style="color: #657b83">pop</span><span style="color: #657b83">(</span><span style="color: #657b83">page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">child</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #dc322f">reversed</span><span style="color: #657b83">(</span><span style="color: #657b83">page</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">children</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">parent_page</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">children</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">.</span><span style="color: #657b83">insert</span><span style="color: #657b83">(</span><span style="color: #657b83">index</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">child</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_parent_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">child</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">]</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">parent_page</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">move_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">parent_page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">before_page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">notify</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #657b83">before_page_id</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #859900">return</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">parent</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">parent_page_id</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">while</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #859900">return</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">parent</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_parent_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">parent</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">parent</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_parent_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">page_id</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">page</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">parent</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">children</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">.</span><span style="color: #657b83">pop</span><span style="color: #657b83">(</span><span style="color: #657b83">index_with_id</span><span style="color: #657b83">(</span><span style="color: #657b83">parent</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">children</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">new_parent</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">parent_page_id</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_parent_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">page_id</span><span style="color: #657b83">]</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">new_parent</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">before_page_id</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">new_parent</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">children</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">page</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">else</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">new_parent</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">children</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">.</span><span style="color: #657b83">insert</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #657b83">index_with_id</span><span style="color: #657b83">(</span><span style="color: #657b83">new_parent</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">children</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">before_page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #657b83">page</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">edit_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">data</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">notify</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">page_id</span><span style="color: #657b83">]</span><span style="color: #657b83">.</span><span style="color: #657b83">update</span><span style="color: #657b83">(</span><span style="color: #657b83">data</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #93a1a1"># </span><span style="color: #93a1a1">Paragraph </span><span style="color: #93a1a1">operations</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">add_paragraph</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">before_id</span><span style="color: #657b83">=</span><span style="color: #268bd2">None</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">notify</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">paragraph</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #2aa198">"</span><span style="color: #2aa198">id</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">genid</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #2aa198">"</span><span style="color: #2aa198">type</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">factory</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #2aa198">"</span><span style="color: #2aa198">text</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #2aa198">"</span><span style="color: #2aa198">factory</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">}</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">page_id</span><span style="color: #657b83">]</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">paragraphs</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_paragraphs</span><span style="color: #657b83">[</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">]</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">move_paragraph</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">source_page</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">source_paragraph</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">target_page</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">before_paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">notify</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">(</span><span style="color: #657b83">source_page</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #657b83">target_page</span><span style="color: #657b83"> </span><span style="color: #859900">and</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">source_paragraph</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #657b83">before_paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #859900">return</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">paragraph</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">delete_paragraph</span><span style="color: #657b83">(</span><span style="color: #657b83">source_page</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">source_paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_add_paragraph</span><span style="color: #657b83">(</span><span style="color: #657b83">target_page</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">before_id</span><span style="color: #657b83">=</span><span style="color: #657b83">before_paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_add_paragraph</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">before_id</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">paragraphs</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">page_id</span><span style="color: #657b83">]</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">paragraphs</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">before_id</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">paragraphs</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">else</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">paragraphs</span><span style="color: #657b83">.</span><span style="color: #657b83">insert</span><span style="color: #657b83">(</span><span style="color: #657b83">index_with_id</span><span style="color: #657b83">(</span><span style="color: #657b83">paragraphs</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">before_id</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_paragraphs</span><span style="color: #657b83">[</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">]</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">delete_paragraph</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph_id</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">notify</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">paragraphs</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_pages</span><span style="color: #657b83">[</span><span style="color: #657b83">page_id</span><span style="color: #657b83">]</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">paragraphs</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">paragraphs</span><span style="color: #657b83">.</span><span style="color: #657b83">pop</span><span style="color: #657b83">(</span><span style="color: #657b83">index_with_id</span><span style="color: #657b83">(</span><span style="color: #657b83">paragraphs</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph_id</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_paragraphs</span><span style="color: #657b83">.</span><span style="color: #657b83">pop</span><span style="color: #657b83">(</span><span style="color: #657b83">paragraph_id</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">edit_paragraph</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">data</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">notify</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_paragraphs</span><span style="color: #657b83">[</span><span style="color: #657b83">paragraph_id</span><span style="color: #657b83">]</span><span style="color: #657b83">.</span><span style="color: #657b83">update</span><span style="color: #657b83">(</span><span style="color: #657b83">data</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h5>Views</h5>

<p>Views provide a read only interface to a document. It is the only way to query a document.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Document&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">get_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">=</span><span style="color: #268bd2">None</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">page_id</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">root_page</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">page_dict</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_pages</span><span style="color: #657b83">.</span><span style="color: #657b83">get</span><span style="color: #657b83">(</span><span style="color: #657b83">page_id</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">page_dict</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">DictPage</span><span style="color: #657b83">(</span><span style="color: #657b83">page_dict</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">DictPage</span><span style="color: #657b83">(</span><span style="color: #dc322f">object</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_dict</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_page_dict</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">page_dict</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@property</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">id</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_page_dict</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@property</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">title</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_page_dict</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">title</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@property</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">paragraphs</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">DictParagraph</span><span style="color: #657b83">.</span><span style="color: #657b83">create</span><span style="color: #657b83">(</span><span style="color: #657b83">paragraph_dict</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph_dict</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_page_dict</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">paragraphs</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@property</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">children</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">DictPage</span><span style="color: #657b83">(</span><span style="color: #657b83">child_dict</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">child_dict</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_page_dict</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">children</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">]</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">DictParagraph</span><span style="color: #657b83">(</span><span style="color: #dc322f">object</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@staticmethod</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">create</span><span style="color: #657b83">(</span><span style="color: #657b83">paragraph_dict</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #2aa198">"</span><span style="color: #2aa198">text</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">DictTextParagraph</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #2aa198">"</span><span style="color: #2aa198">code</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">DictCodeParagraph</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">}</span><span style="color: #657b83">.</span><span style="color: #657b83">get</span><span style="color: #657b83">(</span><span style="color: #657b83">paragraph_dict</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">type</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">DictParagraph</span><span style="color: #657b83">)</span><span style="color: #657b83">(</span><span style="color: #657b83">paragraph_dict</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph_dict</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_paragraph_dict</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph_dict</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@property</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">id</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_paragraph_dict</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@property</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">type</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_paragraph_dict</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">type</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">DictTextParagraph</span><span style="color: #657b83">(</span><span style="color: #657b83">DictParagraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@property</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">filename</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">paragraph.txt</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@property</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">text</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_paragraph_dict</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">text</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@property</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">formatted_text</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">fragments</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">text</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_paragraph_dict</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">text</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">partial</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">while</span><span style="color: #657b83"> </span><span style="color: #657b83">text</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">result</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_get_special_fragment</span><span style="color: #657b83">(</span><span style="color: #657b83">text</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">result</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">partial</span><span style="color: #657b83"> </span><span style="color: #657b83">+</span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">text</span><span style="color: #657b83">[</span><span style="color: #2aa198">0</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">text</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">text</span><span style="color: #657b83">[</span><span style="color: #2aa198">1</span><span style="color: #657b83">:</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">else</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">match</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">fragment</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">result</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">partial</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #657b83">fragments</span><span style="color: #657b83">.</span><span style="color: #657b83">extend</span><span style="color: #657b83">(</span><span style="color: #657b83">Fragment</span><span style="color: #657b83">(</span><span style="color: #657b83">partial</span><span style="color: #657b83">)</span><span style="color: #657b83">.</span><span style="color: #657b83">word_split</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #657b83">partial</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">fragments</span><span style="color: #657b83">.</span><span style="color: #657b83">extend</span><span style="color: #657b83">(</span><span style="color: #657b83">fragment</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">text</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">text</span><span style="color: #657b83">[</span><span style="color: #657b83">match</span><span style="color: #657b83">.</span><span style="color: #657b83">end</span><span style="color: #657b83">(</span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">partial</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">fragments</span><span style="color: #657b83">.</span><span style="color: #657b83">extend</span><span style="color: #657b83">(</span><span style="color: #657b83">Fragment</span><span style="color: #657b83">(</span><span style="color: #657b83">partial</span><span style="color: #657b83">)</span><span style="color: #657b83">.</span><span style="color: #657b83">word_split</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">fragments</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">PATTERNS</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">re</span><span style="color: #657b83">.</span><span style="color: #657b83">compile</span><span style="color: #657b83">(</span><span style="color: #2aa198">r</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\</span><span style="color: #2aa198">*</span><span style="color: #2aa198">\</span><span style="color: #2aa198">*(.+?)</span><span style="color: #2aa198">\</span><span style="color: #2aa198">*</span><span style="color: #2aa198">\</span><span style="color: #2aa198">*</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flags</span><span style="color: #657b83">=</span><span style="color: #657b83">re</span><span style="color: #657b83">.</span><span style="color: #657b83">DOTALL</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">match</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">Fragment</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">match</span><span style="color: #657b83">.</span><span style="color: #657b83">group</span><span style="color: #657b83">(</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">token</span><span style="color: #657b83">=</span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">RLiterate</span><span style="color: #657b83">.</span><span style="color: #657b83">Strong</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">re</span><span style="color: #657b83">.</span><span style="color: #657b83">compile</span><span style="color: #657b83">(</span><span style="color: #2aa198">r</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\</span><span style="color: #2aa198">[(.+?)</span><span style="color: #2aa198">\</span><span style="color: #2aa198">]</span><span style="color: #2aa198">\</span><span style="color: #2aa198">((.+?)</span><span style="color: #2aa198">\</span><span style="color: #2aa198">)</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flags</span><span style="color: #657b83">=</span><span style="color: #657b83">re</span><span style="color: #657b83">.</span><span style="color: #657b83">DOTALL</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">match</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">Fragment</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">match</span><span style="color: #657b83">.</span><span style="color: #657b83">group</span><span style="color: #657b83">(</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">token</span><span style="color: #657b83">=</span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">RLiterate</span><span style="color: #657b83">.</span><span style="color: #657b83">Link</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">url</span><span style="color: #657b83">=</span><span style="color: #657b83">match</span><span style="color: #657b83">.</span><span style="color: #657b83">group</span><span style="color: #657b83">(</span><span style="color: #2aa198">2</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_get_special_fragment</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">text</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">pattern</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">fn</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">PATTERNS</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">match</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">pattern</span><span style="color: #657b83">.</span><span style="color: #657b83">match</span><span style="color: #657b83">(</span><span style="color: #657b83">text</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">match</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">match</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">fn</span><span style="color: #657b83">(</span><span style="color: #657b83">match</span><span style="color: #657b83">)</span><span style="color: #657b83">.</span><span style="color: #657b83">word_split</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">DictCodeParagraph</span><span style="color: #657b83">(</span><span style="color: #657b83">DictParagraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@property</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">text</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_paragraph_dict</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">text</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@property</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">formatted_text</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">try</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">lexer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_get_lexer</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">except</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">lexer</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">pygments</span><span style="color: #657b83">.</span><span style="color: #657b83">lexers</span><span style="color: #657b83">.</span><span style="color: #657b83">TextLexer</span><span style="color: #657b83">(</span><span style="color: #657b83">stripnl</span><span style="color: #657b83">=</span><span style="color: #268bd2">False</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_tokens_to_fragments</span><span style="color: #657b83">(</span><span style="color: #657b83">lexer</span><span style="color: #657b83">.</span><span style="color: #657b83">get_tokens</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@property</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">path</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #dc322f">tuple</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_paragraph_dict</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">path</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@property</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">filename</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">last_part</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">part</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">part</span><span style="color: #657b83">.</span><span style="color: #657b83">startswith</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">&lt;&lt;</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #859900">break</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">last_part</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">part</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">last_part</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@property</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">language</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">try</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">"</span><span style="color: #657b83">.</span><span style="color: #657b83">join</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_get_lexer</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">.</span><span style="color: #657b83">aliases</span><span style="color: #657b83">[</span><span style="color: #657b83">:</span><span style="color: #2aa198">1</span><span style="color: #657b83">]</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">except</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_get_lexer</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">pygments</span><span style="color: #657b83">.</span><span style="color: #657b83">lexers</span><span style="color: #657b83">.</span><span style="color: #657b83">get_lexer_for_filename</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">filename</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">stripnl</span><span style="color: #657b83">=</span><span style="color: #268bd2">False</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_tokens_to_fragments</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">tokens</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">fragments</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">token</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">text</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">tokens</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">fragments</span><span style="color: #657b83">.</span><span style="color: #657b83">extend</span><span style="color: #657b83">(</span><span style="color: #657b83">Fragment</span><span style="color: #657b83">(</span><span style="color: #657b83">text</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">token</span><span style="color: #657b83">=</span><span style="color: #657b83">token</span><span style="color: #657b83">)</span><span style="color: #657b83">.</span><span style="color: #657b83">word_split</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">fragments</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">Fragment</span><span style="color: #657b83">(</span><span style="color: #dc322f">object</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">text</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">token</span><span style="color: #657b83">=</span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">RLiterate</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #657b83">extra</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">text</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">token</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">token</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">extra</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">extra</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">word_split</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">fragments</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">text</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">while</span><span style="color: #657b83"> </span><span style="color: #657b83">text</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">match</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">re</span><span style="color: #657b83">.</span><span style="color: #657b83">match</span><span style="color: #657b83">(</span><span style="color: #2aa198">r</span><span style="color: #2aa198">"</span><span style="color: #2aa198">.+?(</span><span style="color: #2aa198">\</span><span style="color: #2aa198">s+|$)</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">text</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">flags</span><span style="color: #657b83">=</span><span style="color: #657b83">re</span><span style="color: #657b83">.</span><span style="color: #657b83">DOTALL</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">fragments</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">Fragment</span><span style="color: #657b83">(</span><span style="color: #657b83">text</span><span style="color: #657b83">=</span><span style="color: #657b83">match</span><span style="color: #657b83">.</span><span style="color: #657b83">group</span><span style="color: #657b83">(</span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">token</span><span style="color: #657b83">=</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">token</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">*</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">extra</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">text</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">text</span><span style="color: #657b83">[</span><span style="color: #657b83">match</span><span style="color: #657b83">.</span><span style="color: #657b83">end</span><span style="color: #657b83">(</span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">fragments</span><span style="color: #657b83">
</span></pre>

<h4>Layouts</h4>

<p>A layout knows the visual state of the program. It for example knows what pages are expanded/collapsed in the table of contents and what is shown in the workspace.</p>

<p>The layout is recorded in a JSON object that is serialized to disk as soon as something changes.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">Layout</span><span style="color: #657b83">(</span><span style="color: #657b83">Observable</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">&lt;&lt;</span><span style="color: #657b83">Layout</span><span style="color: #657b83">&gt;&gt;</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Layout&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">Observable</span><span style="color: #657b83">.</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">listen</span><span style="color: #657b83">(</span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">write_json_to_file</span><span style="color: #657b83">(</span><span style="color: #657b83">path</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">data</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">os</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">.</span><span style="color: #657b83">exists</span><span style="color: #657b83">(</span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">data</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">load_json_from_file</span><span style="color: #657b83">(</span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">else</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">data</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #657b83">}</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">&lt;&lt;</span><span style="color: #268bd2">__init__</span><span style="color: #657b83">&gt;&gt;</span><span style="color: #657b83">
</span></pre>

<p>The rest of this class provides methods for reading and writing the `data` dict.</p>

<p>The hoisted page is stored in `toc.hoisted_page_id`:</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Layout&gt;&gt; / &lt;&lt;__init__&gt;&gt;</code>

</p>

<pre><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_toc</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">ensure_key</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">data</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">toc</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #657b83">}</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Layout&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">get_hoisted_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_toc</span><span style="color: #657b83">.</span><span style="color: #657b83">get</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">hoisted_page_id</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">set_hoisted_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">notify</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">toc</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_toc</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">hoisted_page_id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">
</span></pre>

<p>The collapsed pages are stored in `toc.collapsed`:</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Layout&gt;&gt; / &lt;&lt;__init__&gt;&gt;</code>

</p>

<pre><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_toc_collapsed</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">ensure_key</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_toc</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">collapsed</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Layout&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">is_collapsed</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_toc_collapsed</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">toggle_collapsed</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">notify</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">toc</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">page_id</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_toc_collapsed</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_toc_collapsed</span><span style="color: #657b83">.</span><span style="color: #657b83">remove</span><span style="color: #657b83">(</span><span style="color: #657b83">page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">else</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_toc_collapsed</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">page_id</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p>The scratch pages are stored in `workspace.scratch`:</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Layout&gt;&gt; / &lt;&lt;__init__&gt;&gt;</code>

</p>

<pre><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_workspace</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">ensure_key</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">data</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">workspace</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #657b83">}</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_workspace_scratch</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">ensure_key</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_workspace</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">scratch</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Layout&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">get_scratch_pages</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_workspace_scratch</span><span style="color: #657b83">[</span><span style="color: #657b83">:</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">set_scratch_pages</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_ids</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">set_pages</span><span style="color: #657b83">(</span><span style="color: #657b83">page_ids</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">column_index</span><span style="color: #657b83">=</span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p>The pages displayed in the columns in the workspace are stored in `workspace.columns`:</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Layout&gt;&gt; / &lt;&lt;__init__&gt;&gt;</code>

</p>

<pre><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_workspace_columns</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">ensure_key</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_workspace</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">columns</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt; / &lt;&lt;Layout&gt;&gt;</code>

</p>

<pre><span style="color: #268bd2">@property</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">columns</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_workspace_columns</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">column</span><span style="color: #657b83">[</span><span style="color: #657b83">:</span><span style="color: #657b83">]</span><span style="color: #657b83"> </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">column</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_workspace_columns</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">else</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">get_scratch_pages</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">open_pages</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page_ids</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">column_index</span><span style="color: #657b83">=</span><span style="color: #268bd2">None</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">notify</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">workspace</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">column_index</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">column_index</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #dc322f">len</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_workspace_columns</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_workspace_columns</span><span style="color: #657b83">[</span><span style="color: #657b83">column_index</span><span style="color: #657b83">:</span><span style="color: #657b83">]</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">page_ids</span><span style="color: #657b83">[</span><span style="color: #657b83">:</span><span style="color: #657b83">]</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span></pre>

<p>Finally we have a utility function for ensuring that a specific key exists in a dictionary.</p>

<p><code>rliterate.py / &lt;&lt;functions&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">ensure_key</span><span style="color: #657b83">(</span><span style="color: #657b83">a_dict</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">key</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">default</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">key</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">a_dict</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">a_dict</span><span style="color: #657b83">[</span><span style="color: #657b83">key</span><span style="color: #657b83">]</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">default</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">a_dict</span><span style="color: #657b83">[</span><span style="color: #657b83">key</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span></pre>

<h4>Themes</h4>

<p>Some parts of the application can be themed. Token types from pygments denote different things that can be styled.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">BaseTheme</span><span style="color: #657b83">(</span><span style="color: #dc322f">object</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">get_style</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">token_type</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">token_type</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">styles</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">styles</span><span style="color: #657b83">[</span><span style="color: #657b83">token_type</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">get_style</span><span style="color: #657b83">(</span><span style="color: #657b83">token_type</span><span style="color: #657b83">.</span><span style="color: #657b83">parent</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;base classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">Style</span><span style="color: #657b83">(</span><span style="color: #dc322f">object</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">color</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">bold</span><span style="color: #657b83">=</span><span style="color: #268bd2">None</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">underlined</span><span style="color: #657b83">=</span><span style="color: #268bd2">None</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">color</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">color</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">color_rgb</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #dc322f">tuple</span><span style="color: #657b83">(</span><span style="color: #657b83">[</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #dc322f">int</span><span style="color: #657b83">(</span><span style="color: #657b83">x</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">16</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">x</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">[</span><span style="color: #2aa198">1</span><span style="color: #657b83">:</span><span style="color: #2aa198">3</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">color</span><span style="color: #657b83">[</span><span style="color: #2aa198">3</span><span style="color: #657b83">:</span><span style="color: #2aa198">5</span><span style="color: #657b83">]</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">color</span><span style="color: #657b83">[</span><span style="color: #2aa198">5</span><span style="color: #657b83">:</span><span style="color: #2aa198">7</span><span style="color: #657b83">]</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">]</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">bold</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">bold</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">underlined</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">underlined</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">get_css</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">color: </span><span style="color: #2aa198">{}</span><span style="color: #2aa198">"</span><span style="color: #657b83">.</span><span style="color: #657b83">format</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">color</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">apply_to_wx_dc</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">dc</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">base_font</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">font</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">base_font</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">bold</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">font</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">font</span><span style="color: #657b83">.</span><span style="color: #657b83">Bold</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">underlined</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">font</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">font</span><span style="color: #657b83">.</span><span style="color: #657b83">Underlined</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">dc</span><span style="color: #657b83">.</span><span style="color: #657b83">SetFont</span><span style="color: #657b83">(</span><span style="color: #657b83">font</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">dc</span><span style="color: #657b83">.</span><span style="color: #657b83">SetTextForeground</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">color_rgb</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p>Here is a theme based on solarized. Mostly stolen from https://github.com/honza/solarized-pygments/blob/master/solarized.py.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">SolarizedTheme</span><span style="color: #657b83">(</span><span style="color: #657b83">BaseTheme</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">base03</span><span style="color: #657b83">  </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#002b36</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">base02</span><span style="color: #657b83">  </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#073642</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">base01</span><span style="color: #657b83">  </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#586e75</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">base00</span><span style="color: #657b83">  </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#657b83</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">base0</span><span style="color: #657b83">   </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#839496</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">base1</span><span style="color: #657b83">   </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#93a1a1</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">base2</span><span style="color: #657b83">   </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#eee8d5</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">base3</span><span style="color: #657b83">   </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#fdf6e3</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">yellow</span><span style="color: #657b83">  </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#b58900</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">orange</span><span style="color: #657b83">  </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#cb4b16</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">red</span><span style="color: #657b83">     </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#dc322f</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">magenta</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#d33682</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">violet</span><span style="color: #657b83">  </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#6c71c4</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">blue</span><span style="color: #657b83">    </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#268bd2</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">cyan</span><span style="color: #657b83">    </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#2aa198</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">green</span><span style="color: #657b83">   </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#859900</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">text</span><span style="color: #657b83">    </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">#2e3436</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">styles</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">{</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">:</span><span style="color: #657b83">                     </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">base00</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">Keyword</span><span style="color: #657b83">:</span><span style="color: #657b83">             </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">green</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">Keyword</span><span style="color: #657b83">.</span><span style="color: #657b83">Constant</span><span style="color: #657b83">:</span><span style="color: #657b83">    </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">cyan</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">Keyword</span><span style="color: #657b83">.</span><span style="color: #657b83">Declaration</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">blue</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">Keyword</span><span style="color: #657b83">.</span><span style="color: #657b83">Namespace</span><span style="color: #657b83">:</span><span style="color: #657b83">   </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">orange</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">Name</span><span style="color: #657b83">.</span><span style="color: #657b83">Builtin</span><span style="color: #657b83">:</span><span style="color: #657b83">        </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">red</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">Name</span><span style="color: #657b83">.</span><span style="color: #657b83">Builtin</span><span style="color: #657b83">.</span><span style="color: #657b83">Pseudo</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">blue</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">Name</span><span style="color: #657b83">.</span><span style="color: #657b83">Class</span><span style="color: #657b83">:</span><span style="color: #657b83">          </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">blue</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">Name</span><span style="color: #657b83">.</span><span style="color: #657b83">Decorator</span><span style="color: #657b83">:</span><span style="color: #657b83">      </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">blue</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">Name</span><span style="color: #657b83">.</span><span style="color: #657b83">Entity</span><span style="color: #657b83">:</span><span style="color: #657b83">         </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">violet</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">Name</span><span style="color: #657b83">.</span><span style="color: #657b83">Exception</span><span style="color: #657b83">:</span><span style="color: #657b83">      </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">yellow</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">Name</span><span style="color: #657b83">.</span><span style="color: #657b83">Function</span><span style="color: #657b83">:</span><span style="color: #657b83">       </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">blue</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">String</span><span style="color: #657b83">:</span><span style="color: #657b83">              </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">cyan</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">Number</span><span style="color: #657b83">:</span><span style="color: #657b83">              </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">cyan</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">Operator</span><span style="color: #657b83">.</span><span style="color: #657b83">Word</span><span style="color: #657b83">:</span><span style="color: #657b83">       </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">green</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">Comment</span><span style="color: #657b83">:</span><span style="color: #657b83">             </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">base1</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">RLiterate</span><span style="color: #657b83">:</span><span style="color: #657b83">           </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">text</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">RLiterate</span><span style="color: #657b83">.</span><span style="color: #657b83">Strong</span><span style="color: #657b83">:</span><span style="color: #657b83">    </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">text</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">bold</span><span style="color: #657b83">=</span><span style="color: #268bd2">True</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">Token</span><span style="color: #657b83">.</span><span style="color: #657b83">RLiterate</span><span style="color: #657b83">.</span><span style="color: #657b83">Link</span><span style="color: #657b83">:</span><span style="color: #657b83">      </span><span style="color: #657b83">Style</span><span style="color: #657b83">(</span><span style="color: #657b83">color</span><span style="color: #657b83">=</span><span style="color: #657b83">blue</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">underlined</span><span style="color: #657b83">=</span><span style="color: #268bd2">True</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">}</span><span style="color: #657b83">
</span></pre>

<h3>Generating output</h3>

<h4>Code files</h4>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">FileGenerator</span><span style="color: #657b83">(</span><span style="color: #dc322f">object</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">listener</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">Listener</span><span style="color: #657b83">(</span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_generate</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">set_document</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">document</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">document</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">listener</span><span style="color: #657b83">.</span><span style="color: #657b83">set_observable</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_generate</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_parts</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">defaultdict</span><span style="color: #657b83">(</span><span style="color: #dc322f">list</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_collect_parts</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">.</span><span style="color: #657b83">get_page</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_generate_files</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_collect_parts</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraphs</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">type</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">code</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">line</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">.</span><span style="color: #657b83">splitlines</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_parts</span><span style="color: #657b83">[</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">]</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">line</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">child</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">children</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_collect_parts</span><span style="color: #657b83">(</span><span style="color: #657b83">child</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_generate_files</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">key</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_parts</span><span style="color: #657b83">.</span><span style="color: #657b83">keys</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">filepath</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_get_filepath</span><span style="color: #657b83">(</span><span style="color: #657b83">key</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">filepath</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #dc322f">open</span><span style="color: #657b83">(</span><span style="color: #657b83">filepath</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">w</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #859900">as</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">key</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">key</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">prefix</span><span style="color: #657b83">=</span><span style="color: #2aa198">"</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">line</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_parts</span><span style="color: #657b83">[</span><span style="color: #657b83">key</span><span style="color: #657b83">]</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">match</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">re</span><span style="color: #657b83">.</span><span style="color: #657b83">match</span><span style="color: #657b83">(</span><span style="color: #2aa198">r</span><span style="color: #2aa198">"</span><span style="color: #2aa198">^(</span><span style="color: #2aa198">\</span><span style="color: #2aa198">s*)(&lt;&lt;.*&gt;&gt;)</span><span style="color: #2aa198">\</span><span style="color: #2aa198">s*$</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">line</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">match</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">key</span><span style="color: #657b83"> </span><span style="color: #657b83">+</span><span style="color: #657b83"> </span><span style="color: #657b83">(</span><span style="color: #657b83">match</span><span style="color: #657b83">.</span><span style="color: #657b83">group</span><span style="color: #657b83">(</span><span style="color: #2aa198">2</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">prefix</span><span style="color: #657b83">=</span><span style="color: #657b83">prefix</span><span style="color: #657b83">+</span><span style="color: #657b83">match</span><span style="color: #657b83">.</span><span style="color: #657b83">group</span><span style="color: #657b83">(</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">else</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #dc322f">len</span><span style="color: #657b83">(</span><span style="color: #657b83">line</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #657b83">&gt;</span><span style="color: #657b83"> </span><span style="color: #2aa198">0</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #657b83">prefix</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #657b83">line</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_get_filepath</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">key</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #dc322f">len</span><span style="color: #657b83">(</span><span style="color: #657b83">key</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #2aa198">0</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">part</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">key</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">part</span><span style="color: #657b83">.</span><span style="color: #657b83">startswith</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">&lt;&lt;</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #859900">and</span><span style="color: #657b83"> </span><span style="color: #657b83">part</span><span style="color: #657b83">.</span><span style="color: #657b83">endswith</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">&gt;&gt;</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">os</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">.</span><span style="color: #657b83">join</span><span style="color: #657b83">(</span><span style="color: #657b83">*</span><span style="color: #657b83">key</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h4>Markdown book</h4>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">MarkdownGenerator</span><span style="color: #657b83">(</span><span style="color: #dc322f">object</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">listener</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">Listener</span><span style="color: #657b83">(</span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_generate</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">path</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">set_document</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">document</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">document</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">listener</span><span style="color: #657b83">.</span><span style="color: #657b83">set_observable</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_generate</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #dc322f">open</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">w</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #859900">as</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_page</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">.</span><span style="color: #657b83">get_page</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">level</span><span style="color: #657b83">=</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">#</span><span style="color: #2aa198">"</span><span style="color: #657b83">*</span><span style="color: #657b83">level</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198"> </span><span style="color: #2aa198">"</span><span style="color: #657b83">+</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">title</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraphs</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">{</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #2aa198">"</span><span style="color: #2aa198">text</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_text</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #2aa198">"</span><span style="color: #2aa198">code</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_code</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">}</span><span style="color: #657b83">.</span><span style="color: #657b83">get</span><span style="color: #657b83">(</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">type</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_unknown</span><span style="color: #657b83">)</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">child</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">children</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_page</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">child</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">level</span><span style="color: #657b83">+</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_text</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">text</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #657b83">text</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_code</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">code</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">`</span><span style="color: #2aa198">"</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198"> / </span><span style="color: #2aa198">"</span><span style="color: #657b83">.</span><span style="color: #657b83">join</span><span style="color: #657b83">(</span><span style="color: #657b83">code</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198">`:</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">```</span><span style="color: #2aa198">"</span><span style="color: #657b83">+</span><span style="color: #657b83">code</span><span style="color: #657b83">.</span><span style="color: #657b83">language</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">line</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">code</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">.</span><span style="color: #657b83">splitlines</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #657b83">line</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">```</span><span style="color: #2aa198">"</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_unknown</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">Unknown </span><span style="color: #2aa198">type </span><span style="color: #2aa198">= </span><span style="color: #2aa198">"</span><span style="color: #657b83">+</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">type</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h4>HTML</h4>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">HTMLGenerator</span><span style="color: #657b83">(</span><span style="color: #dc322f">object</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">listener</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">Listener</span><span style="color: #657b83">(</span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_generate</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">document</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">path</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">set_project</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">project</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">listener</span><span style="color: #657b83">.</span><span style="color: #657b83">set_observable</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_generate</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #dc322f">open</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">w</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #859900">as</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_page</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">get_page</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_page</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">level</span><span style="color: #657b83">=</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_tag</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">h{}</span><span style="color: #2aa198">"</span><span style="color: #657b83">.</span><span style="color: #657b83">format</span><span style="color: #657b83">(</span><span style="color: #657b83">level</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_write_html</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">title</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraphs</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">{</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #2aa198">"</span><span style="color: #2aa198">text</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_text</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #2aa198">"</span><span style="color: #2aa198">code</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_code</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">}</span><span style="color: #657b83">.</span><span style="color: #657b83">get</span><span style="color: #657b83">(</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">type</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_unknown</span><span style="color: #657b83">)</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">child</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">children</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_page</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">child</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">level</span><span style="color: #657b83">+</span><span style="color: #2aa198">1</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_text</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">text</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_tag</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">p</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #657b83">text</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_code</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">code</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_tag</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">p</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_tag</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">code</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_write_html</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198"> / </span><span style="color: #2aa198">"</span><span style="color: #657b83">.</span><span style="color: #657b83">join</span><span style="color: #657b83">(</span><span style="color: #657b83">code</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_tag</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">pre</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">fragment</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">code</span><span style="color: #657b83">.</span><span style="color: #657b83">formatted_text</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_tag</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #2aa198">"</span><span style="color: #2aa198">span</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #657b83">newlines</span><span style="color: #657b83">=</span><span style="color: #268bd2">False</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #657b83">args</span><span style="color: #657b83">=</span><span style="color: #657b83">{</span><span style="color: #2aa198">"</span><span style="color: #2aa198">style</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">project</span><span style="color: #657b83">.</span><span style="color: #657b83">get_style</span><span style="color: #657b83">(</span><span style="color: #657b83">fragment</span><span style="color: #657b83">.</span><span style="color: #657b83">token</span><span style="color: #657b83">)</span><span style="color: #657b83">.</span><span style="color: #657b83">get_css</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">}</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_write_html</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">fragment</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_unknown</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_tag</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">p</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_write_html</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">Unknown </span><span style="color: #2aa198">paragraph...</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_write_html</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">text</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #657b83">xml</span><span style="color: #657b83">.</span><span style="color: #657b83">sax</span><span style="color: #657b83">.</span><span style="color: #657b83">saxutils</span><span style="color: #657b83">.</span><span style="color: #657b83">escape</span><span style="color: #657b83">(</span><span style="color: #657b83">text</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@contextlib.contextmanager</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_tag</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">tag</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">newlines</span><span style="color: #657b83">=</span><span style="color: #268bd2">True</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">args</span><span style="color: #657b83">=</span><span style="color: #657b83">{</span><span style="color: #657b83">}</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">args_string</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">"</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">args</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">args_string</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198"> </span><span style="color: #2aa198">"</span><span style="color: #657b83"> </span><span style="color: #657b83">+</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198"> </span><span style="color: #2aa198">"</span><span style="color: #657b83">.</span><span style="color: #657b83">join</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">{}=</span><span style="color: #2aa198">\"</span><span style="color: #2aa198">{}</span><span style="color: #2aa198">\"</span><span style="color: #2aa198">"</span><span style="color: #657b83">.</span><span style="color: #657b83">format</span><span style="color: #657b83">(</span><span style="color: #657b83">k</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">v</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">k</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">v</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">args</span><span style="color: #657b83">.</span><span style="color: #657b83">items</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">&lt;{}{}&gt;</span><span style="color: #2aa198">"</span><span style="color: #657b83">.</span><span style="color: #657b83">format</span><span style="color: #657b83">(</span><span style="color: #657b83">tag</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">args_string</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">yield</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">&lt;/{}&gt;</span><span style="color: #2aa198">"</span><span style="color: #657b83">.</span><span style="color: #657b83">format</span><span style="color: #657b83">(</span><span style="color: #657b83">tag</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">newlines</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h4>Textual diffing</h4>

<p>This generates a file that is suitable for textual diffing.</p>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">TextDiff</span><span style="color: #657b83">(</span><span style="color: #dc322f">object</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">listener</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">Listener</span><span style="color: #657b83">(</span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_generate</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">path</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">set_document</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">document</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">document</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">listener</span><span style="color: #657b83">.</span><span style="color: #657b83">set_observable</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_generate</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #dc322f">open</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">w</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #859900">as</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">pages</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_collect_pages</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">document</span><span style="color: #657b83">.</span><span style="color: #657b83">get_page</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_pages</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_collect_pages</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">pages</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">page</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">child</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">children</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_collect_pages</span><span style="color: #657b83">(</span><span style="color: #657b83">child</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_pages</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #dc322f">sorted</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">pages</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">key</span><span style="color: #657b83">=</span><span style="color: #859900">lambda</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">id</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">: </span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">title</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">page</span><span style="color: #657b83">.</span><span style="color: #657b83">paragraphs</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">{</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #2aa198">"</span><span style="color: #2aa198">text</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_text</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #2aa198">"</span><span style="color: #2aa198">code</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_code</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #657b83">}</span><span style="color: #657b83">.</span><span style="color: #657b83">get</span><span style="color: #657b83">(</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">type</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_render_unknown</span><span style="color: #657b83">)</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_text</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">text</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #657b83">text</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_code</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">code</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">`</span><span style="color: #2aa198">"</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198"> / </span><span style="color: #2aa198">"</span><span style="color: #657b83">.</span><span style="color: #657b83">join</span><span style="color: #657b83">(</span><span style="color: #657b83">code</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198">`:</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">line</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">code</span><span style="color: #657b83">.</span><span style="color: #657b83">text</span><span style="color: #657b83">.</span><span style="color: #657b83">splitlines</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">    </span><span style="color: #2aa198">"</span><span style="color: #657b83">+</span><span style="color: #657b83">line</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_render_unknown</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">paragraph</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">Unknown </span><span style="color: #2aa198">type </span><span style="color: #2aa198">= </span><span style="color: #2aa198">"</span><span style="color: #657b83">+</span><span style="color: #657b83">paragraph</span><span style="color: #657b83">.</span><span style="color: #657b83">type</span><span style="color: #657b83">+</span><span style="color: #2aa198">"</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">\n</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h3>Publish subscribe mechanisms</h3>

<p><code>rliterate.py / &lt;&lt;base classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">Observable</span><span style="color: #657b83">(</span><span style="color: #dc322f">object</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_notify_count</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">0</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_listeners</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">[</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">listen</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">fn</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">events</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_listeners</span><span style="color: #657b83">.</span><span style="color: #657b83">append</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #657b83">fn</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">events</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">unlisten</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">fn</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">events</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_listeners</span><span style="color: #657b83">.</span><span style="color: #657b83">remove</span><span style="color: #657b83">(</span><span style="color: #657b83">(</span><span style="color: #657b83">fn</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">events</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #268bd2">@contextlib.contextmanager</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">notify</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">=</span><span style="color: #2aa198">"</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_notify_count</span><span style="color: #657b83"> </span><span style="color: #657b83">+</span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">1</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">try</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">yield</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">finally</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_notify_count</span><span style="color: #657b83"> </span><span style="color: #657b83">-</span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #2aa198">1</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_notify</span><span style="color: #657b83">(</span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">notify_forwarder</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">prefix</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">forwarder</span><span style="color: #657b83">(</span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_notify</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">{}.{}</span><span style="color: #2aa198">"</span><span style="color: #657b83">.</span><span style="color: #657b83">format</span><span style="color: #657b83">(</span><span style="color: #657b83">prefix</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">forwarder</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_notify</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_notify_count</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #2aa198">0</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">fn</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">fn_events</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_listeners</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">_is_match</span><span style="color: #657b83">(</span><span style="color: #657b83">fn_events</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                    </span><span style="color: #657b83">fn</span><span style="color: #657b83">(</span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">_is_match</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">fn_events</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #dc322f">len</span><span style="color: #657b83">(</span><span style="color: #657b83">fn_events</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #2aa198">0</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">True</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">fn_event</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">fn_events</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">is_prefix</span><span style="color: #657b83">(</span><span style="color: #657b83">fn_event</span><span style="color: #657b83">.</span><span style="color: #657b83">split</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">.</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">event</span><span style="color: #657b83">.</span><span style="color: #657b83">split</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">.</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">                </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">True</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">False</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;functions&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">is_prefix</span><span style="color: #657b83">(</span><span style="color: #657b83">left</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">right</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">left</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #657b83">right</span><span style="color: #657b83">[</span><span style="color: #657b83">:</span><span style="color: #dc322f">len</span><span style="color: #657b83">(</span><span style="color: #657b83">left</span><span style="color: #657b83">)</span><span style="color: #657b83">]</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;classes&gt;&gt;</code>

</p>

<pre><span style="color: #859900">class</span><span style="color: #657b83"> </span><span style="color: #268bd2">Listener</span><span style="color: #657b83">(</span><span style="color: #dc322f">object</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">__init__</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">fn</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #657b83">events</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">fn</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">fn</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">events</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">events</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">observable</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">set_observable</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">observable</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">observable</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">observable</span><span style="color: #657b83">.</span><span style="color: #657b83">unlisten</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">fn</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">events</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">observable</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">observable</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">observable</span><span style="color: #657b83">.</span><span style="color: #657b83">listen</span><span style="color: #657b83">(</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">fn</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">*</span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">events</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">self</span><span style="color: #657b83">.</span><span style="color: #657b83">fn</span><span style="color: #657b83">(</span><span style="color: #2aa198">"</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h3>JSON serialization mechanisms</h3>

<p><code>rliterate.py / &lt;&lt;functions&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">load_json_from_file</span><span style="color: #657b83">(</span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #dc322f">open</span><span style="color: #657b83">(</span><span style="color: #657b83">path</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">r</span><span style="color: #2aa198">"</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #859900">as</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">json</span><span style="color: #657b83">.</span><span style="color: #657b83">load</span><span style="color: #657b83">(</span><span style="color: #657b83">f</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;functions&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">write_json_to_file</span><span style="color: #657b83">(</span><span style="color: #657b83">path</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">data</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #657b83">safely_write_file</span><span style="color: #657b83">(</span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #859900">as</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">json</span><span style="color: #657b83">.</span><span style="color: #657b83">dump</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">data</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">sort_keys</span><span style="color: #657b83">=</span><span style="color: #268bd2">True</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">indent</span><span style="color: #657b83">=</span><span style="color: #2aa198">0</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">separators</span><span style="color: #657b83">=</span><span style="color: #657b83">(</span><span style="color: #2aa198">'</span><span style="color: #2aa198">,</span><span style="color: #2aa198">'</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">'</span><span style="color: #2aa198">:</span><span style="color: #2aa198">'</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<p>This functions tries to write safely to a file. The file will either be completely written or not modified at all. It is achieved by first writing to a temporary file and then performing a rename.</p>

<p><code>rliterate.py / &lt;&lt;functions&gt;&gt;</code>

</p>

<pre><span style="color: #268bd2">@contextlib.contextmanager</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">safely_write_file</span><span style="color: #657b83">(</span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #657b83">tempfile</span><span style="color: #657b83">.</span><span style="color: #657b83">NamedTemporaryFile</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #dc322f">dir</span><span style="color: #657b83">=</span><span style="color: #657b83">os</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">.</span><span style="color: #657b83">dirname</span><span style="color: #657b83">(</span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">prefix</span><span style="color: #657b83">=</span><span style="color: #657b83">os</span><span style="color: #657b83">.</span><span style="color: #657b83">path</span><span style="color: #657b83">.</span><span style="color: #657b83">basename</span><span style="color: #657b83">(</span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #657b83">+</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">.tmp</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">delete</span><span style="color: #657b83">=</span><span style="color: #268bd2">False</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #859900">as</span><span style="color: #657b83"> </span><span style="color: #657b83">tmp</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">yield</span><span style="color: #657b83"> </span><span style="color: #657b83">tmp</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">os</span><span style="color: #657b83">.</span><span style="color: #657b83">rename</span><span style="color: #657b83">(</span><span style="color: #657b83">tmp</span><span style="color: #657b83">.</span><span style="color: #657b83">name</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">path</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h3>Functions</h3>

<p><code>rliterate.py / &lt;&lt;functions&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">genid</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">uuid</span><span style="color: #657b83">.</span><span style="color: #657b83">uuid4</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">.</span><span style="color: #657b83">hex</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">create_font</span><span style="color: #657b83">(</span><span style="color: #657b83">monospace</span><span style="color: #657b83">=</span><span style="color: #268bd2">False</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">size</span><span style="color: #657b83">=</span><span style="color: #2aa198">10</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">bold</span><span style="color: #657b83">=</span><span style="color: #268bd2">False</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Font</span><span style="color: #657b83">(</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">size</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">FONTFAMILY_TELETYPE</span><span style="color: #657b83"> </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">monospace</span><span style="color: #657b83"> </span><span style="color: #859900">else</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">FONTFAMILY_DEFAULT</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">FONTSTYLE_NORMAL</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">FONTWEIGHT_BOLD</span><span style="color: #657b83"> </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">bold</span><span style="color: #657b83"> </span><span style="color: #859900">else</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">FONTWEIGHT_NORMAL</span><span style="color: #657b83">,</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #268bd2">False</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">find_first</span><span style="color: #657b83">(</span><span style="color: #657b83">items</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">action</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">item</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #657b83">items</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">result</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">action</span><span style="color: #657b83">(</span><span style="color: #657b83">item</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">result</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">result</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">pairs</span><span style="color: #657b83">(</span><span style="color: #657b83">items</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #dc322f">zip</span><span style="color: #657b83">(</span><span style="color: #657b83">items</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">items</span><span style="color: #657b83">[</span><span style="color: #2aa198">1</span><span style="color: #657b83">:</span><span style="color: #657b83">]</span><span style="color: #657b83">+</span><span style="color: #657b83">[</span><span style="color: #268bd2">None</span><span style="color: #657b83">]</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">min_or_none</span><span style="color: #657b83">(</span><span style="color: #657b83">items</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">key</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #859900">not</span><span style="color: #657b83"> </span><span style="color: #657b83">items</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #dc322f">min</span><span style="color: #657b83">(</span><span style="color: #657b83">items</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">key</span><span style="color: #657b83">=</span><span style="color: #657b83">key</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">index_with_id</span><span style="color: #657b83">(</span><span style="color: #657b83">items</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">item_id</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">for</span><span style="color: #657b83"> </span><span style="color: #657b83">index</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">item</span><span style="color: #657b83"> </span><span style="color: #859900">in</span><span style="color: #657b83"> </span><span style="color: #dc322f">enumerate</span><span style="color: #657b83">(</span><span style="color: #657b83">items</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">item</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">id</span><span style="color: #2aa198">"</span><span style="color: #657b83">]</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #657b83">item_id</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">index</span><span style="color: #657b83">
</span></pre>

<p><code>rliterate.py / &lt;&lt;functions&gt;&gt;</code>

</p>

<pre><span style="color: #859900">def</span><span style="color: #657b83"> </span><span style="color: #268bd2">edit_in_gvim</span><span style="color: #657b83">(</span><span style="color: #657b83">text</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">filename</span><span style="color: #657b83">)</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #859900">with</span><span style="color: #657b83"> </span><span style="color: #657b83">tempfile</span><span style="color: #657b83">.</span><span style="color: #657b83">NamedTemporaryFile</span><span style="color: #657b83">(</span><span style="color: #657b83">suffix</span><span style="color: #657b83">=</span><span style="color: #2aa198">"</span><span style="color: #2aa198">-rliterate-external-</span><span style="color: #2aa198">"</span><span style="color: #657b83">+</span><span style="color: #657b83">filename</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #859900">as</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">write</span><span style="color: #657b83">(</span><span style="color: #657b83">text</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">flush</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">p</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">subprocess</span><span style="color: #657b83">.</span><span style="color: #657b83">Popen</span><span style="color: #657b83">(</span><span style="color: #657b83">[</span><span style="color: #2aa198">"</span><span style="color: #2aa198">gvim</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">--nofork</span><span style="color: #2aa198">"</span><span style="color: #657b83">,</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">name</span><span style="color: #657b83">]</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">while</span><span style="color: #657b83"> </span><span style="color: #657b83">p</span><span style="color: #657b83">.</span><span style="color: #657b83">poll</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83"> </span><span style="color: #859900">is</span><span style="color: #657b83"> </span><span style="color: #268bd2">None</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">Yield</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">            </span><span style="color: #657b83">time</span><span style="color: #657b83">.</span><span style="color: #657b83">sleep</span><span style="color: #657b83">(</span><span style="color: #2aa198">0.1</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">seek</span><span style="color: #657b83">(</span><span style="color: #2aa198">0</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">        </span><span style="color: #859900">return</span><span style="color: #657b83"> </span><span style="color: #657b83">f</span><span style="color: #657b83">.</span><span style="color: #657b83">read</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h3>Main Python file</h3>

<p><code>rliterate.py</code>

</p>

<pre><span style="color: #cb4b16">from</span><span style="color: #657b83"> </span><span style="color: #657b83">collections</span><span style="color: #657b83"> </span><span style="color: #cb4b16">import</span><span style="color: #657b83"> </span><span style="color: #657b83">defaultdict</span><span style="color: #657b83">
</span><span style="color: #cb4b16">import</span><span style="color: #657b83"> </span><span style="color: #657b83">contextlib</span><span style="color: #657b83">
</span><span style="color: #cb4b16">import</span><span style="color: #657b83"> </span><span style="color: #657b83">json</span><span style="color: #657b83">
</span><span style="color: #cb4b16">import</span><span style="color: #657b83"> </span><span style="color: #657b83">os</span><span style="color: #657b83">
</span><span style="color: #cb4b16">import</span><span style="color: #657b83"> </span><span style="color: #657b83">re</span><span style="color: #657b83">
</span><span style="color: #cb4b16">import</span><span style="color: #657b83"> </span><span style="color: #657b83">subprocess</span><span style="color: #657b83">
</span><span style="color: #cb4b16">import</span><span style="color: #657b83"> </span><span style="color: #657b83">sys</span><span style="color: #657b83">
</span><span style="color: #cb4b16">import</span><span style="color: #657b83"> </span><span style="color: #657b83">tempfile</span><span style="color: #657b83">
</span><span style="color: #cb4b16">import</span><span style="color: #657b83"> </span><span style="color: #657b83">time</span><span style="color: #657b83">
</span><span style="color: #cb4b16">import</span><span style="color: #657b83"> </span><span style="color: #657b83">uuid</span><span style="color: #657b83">
</span><span style="color: #cb4b16">import</span><span style="color: #657b83"> </span><span style="color: #657b83">webbrowser</span><span style="color: #657b83">
</span><span style="color: #cb4b16">import</span><span style="color: #657b83"> </span><span style="color: #657b83">xml.sax.saxutils</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #cb4b16">import</span><span style="color: #657b83"> </span><span style="color: #657b83">pygments.lexers</span><span style="color: #657b83">
</span><span style="color: #cb4b16">from</span><span style="color: #657b83"> </span><span style="color: #657b83">pygments.token</span><span style="color: #657b83"> </span><span style="color: #cb4b16">import</span><span style="color: #657b83"> </span><span style="color: #657b83">Token</span><span style="color: #657b83">
</span><span style="color: #cb4b16">import</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">
</span><span style="color: #cb4b16">import</span><span style="color: #657b83"> </span><span style="color: #657b83">wx.lib.newevent</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">&lt;&lt;</span><span style="color: #657b83">constants</span><span style="color: #657b83">&gt;&gt;</span><span style="color: #657b83">
</span><span style="color: #657b83">&lt;&lt;</span><span style="color: #657b83">base</span><span style="color: #657b83"> </span><span style="color: #657b83">classes</span><span style="color: #657b83">&gt;&gt;</span><span style="color: #657b83">
</span><span style="color: #657b83">&lt;&lt;</span><span style="color: #657b83">classes</span><span style="color: #657b83">&gt;&gt;</span><span style="color: #657b83">
</span><span style="color: #657b83">&lt;&lt;</span><span style="color: #657b83">functions</span><span style="color: #657b83">&gt;&gt;</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #657b83">
</span><span style="color: #859900">if</span><span style="color: #657b83"> </span><span style="color: #657b83">__name__</span><span style="color: #657b83"> </span><span style="color: #657b83">==</span><span style="color: #657b83"> </span><span style="color: #2aa198">"</span><span style="color: #2aa198">__main__</span><span style="color: #2aa198">"</span><span style="color: #657b83">:</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">app</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">wx</span><span style="color: #657b83">.</span><span style="color: #657b83">App</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">main_frame</span><span style="color: #657b83"> </span><span style="color: #657b83">=</span><span style="color: #657b83"> </span><span style="color: #657b83">MainFrame</span><span style="color: #657b83">(</span><span style="color: #657b83">filepath</span><span style="color: #657b83">=</span><span style="color: #657b83">sys</span><span style="color: #657b83">.</span><span style="color: #657b83">argv</span><span style="color: #657b83">[</span><span style="color: #2aa198">1</span><span style="color: #657b83">]</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">main_frame</span><span style="color: #657b83">.</span><span style="color: #657b83">Show</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span><span style="color: #657b83">    </span><span style="color: #657b83">app</span><span style="color: #657b83">.</span><span style="color: #657b83">MainLoop</span><span style="color: #657b83">(</span><span style="color: #657b83">)</span><span style="color: #657b83">
</span></pre>

<h2>Things I learned</h2>

<p>DoDragDrop must be called from within an event handler.</p>

<p>Font must be assigned before setting a label, otherwise size calculations will be wrong? Must investigate further.</p>

<h2>TODO</h2>

<p>Random notes of what I might want to work on in the future.</p>

<p>* Multiple editors can be opened (only last opened is saved)
* Factory should drop right into edit mode
* Highlighting of toc rows is not always up to date
* Invalid drop targets are still shown
    * Hide dragged item?
* Code editor
    * Tab indents with tab: should indent 4 spaces?
    * Shift+Tab deletes: should dedent
* Normalize paragraph when saving
    * Split into multiple paragraphs on more than one newline
    * Remove single newlines
    * Remove paragraph if text is empty
* Missing page operations
    * Add (before, after)
* Missing paragraph operations
    * Context menu with add paragraph before/after
* File generator writes empty filename
* There is no way to control empty lines from placeholders
* There is no list paragraph type
* Save button (in code editor) is very far down if there is lots of code and only top is edited
* Not possible to go to a page with Ctrl+T
* Highlight object being dragged somehow (screenshot?)
* Save when clicking outside text field (how to do this?)
* This is really a writing tool
    * Spell checking
* Final test: rewrite rlselect (or other program) using rliterate
    1. Import all source code as is
    2. Write narrative
    3. Ensure generated files are not changed
* Highlight active page in TOC
* Right click should only be generated on up if first down
* Workspace should not be wider that a column, that creates an unnecessary scrollbar
* Literate programming treats any target programming language as an assembly language
* TOC should only expand first 3(?) levels when opening a file for the first time
* Deleting root (even hoisted root) gives error
* Reading tool: Code can either be read in chunks or the final output. And you can follow links between them.
* Undo (use immutable data types (pyrsistent?))
* Diff two rliterate documents
* Search and replace
* Highlight placeholders in code fragments
* `word_split` should put white space in separate fragment and rich text display should have `skip_leading_space` option
* Export to stand-alone html for use in blog
* Drag and drop does not work om Mac (incorrect coordinate calculations?)
* Dynamic scripting
    * Show graph paragraph based on data paragraph defined earlier on the page (or on other page)
* Editors: highlight the word/fragment that is double clicked
* Paragraph editor has comment: extract comment to prose</p>

